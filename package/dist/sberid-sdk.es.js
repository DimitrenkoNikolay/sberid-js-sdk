var e;function t(e,n){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},t(e,n)}function n(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=i(e);if(t){var o=i(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function i(e){return i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},i(e)}function r(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o,s,a=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=o.call(n)).done)&&(a.push(i.value),a.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw r}}return a}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function c(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */c=function(){return t};var e,t={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function d(e,t,n,i){var o=t&&t.prototype instanceof w?t:w,s=Object.create(o.prototype),a=new T(i||[]);return r(s,"_invoke",{value:A(e,n,a)}),s}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var f="suspendedStart",p="suspendedYield",g="executing",v="completed",b={};function w(){}function y(){}function k(){}var C={};l(C,s,(function(){return this}));var L=Object.getPrototypeOf,_=L&&L(L(P([])));_&&_!==n&&i.call(_,s)&&(C=_);var S=k.prototype=w.prototype=Object.create(C);function E(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function n(r,o,s,a){var c=h(e[r],e,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==m(l)&&i.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(l).then((function(e){u.value=e,s(u)}),(function(e){return n("throw",e,s,a)}))}a(c.arg)}var o;r(this,"_invoke",{value:function(e,i){function r(){return new t((function(t,r){n(e,i,t,r)}))}return o=o?o.then(r,r):r()}})}function A(t,n,i){var r=f;return function(o,s){if(r===g)throw new Error("Generator is already running");if(r===v){if("throw"===o)throw s;return{value:e,done:!0}}for(i.method=o,i.arg=s;;){var a=i.delegate;if(a){var c=O(a,i);if(c){if(c===b)continue;return c}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===f)throw r=v,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=g;var u=h(t,n,i);if("normal"===u.type){if(r=i.done?v:p,u.arg===b)continue;return{value:u.arg,done:i.done}}"throw"===u.type&&(r=v,i.method="throw",i.arg=u.arg)}}}function O(t,n){var i=n.method,r=t.iterator[i];if(r===e)return n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=e,O(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),b;var o=h(r,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,b;var s=o.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,b):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,b)}function U(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(U,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[s];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(m(t)+" is not iterable")}return y.prototype=k,r(S,"constructor",{value:k,configurable:!0}),r(k,"constructor",{value:y,configurable:!0}),y.displayName=l(k,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,k):(e.__proto__=k,l(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},E(x.prototype),l(x.prototype,a,(function(){return this})),t.AsyncIterator=x,t.async=function(e,n,i,r,o){void 0===o&&(o=Promise);var s=new x(d(e,n,i,r),o);return t.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},E(S),l(S,u,"Generator"),l(S,s,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},t.values=P,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(i,r){return a.type="throw",a.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),u=i.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,b):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),b},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),b}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;I(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:P(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),b}},t}function u(e,t,n,i,r,o,s){try{var a=e[o](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(i,r)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function s(e){u(o,i,r,s,a,"next",e)}function a(e){u(o,i,r,s,a,"throw",e)}s(void 0)}))}}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return(t=b(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,b(i.key),i)}}function v(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function b(e){var t=function(e,t){if("object"!==m(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==m(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===m(t)?t:String(t)}function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}var w=Object.defineProperty,y=function(e,t,n){return function(e,t,n){t in e?w(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=m(t)?t+"":t,n),n},k=function(e){return e.COOKIE_AUTOUPDATE="cookie2autoupdate",e.AGRESSIVE_LOGIN="aggressivelogin",e.FAST_LOGIN="fastlogin",e.NONE="none",e}(k||{}),C=function(e){return e.SAFARI="Safari",e.PLAYSTATION_4="PlayStation 4",e.ANDROID_BROWSER="Android Browser",e.CHROME="Chrome",e.CHROMIUM="Chromium",e.ELECTRON="Electron",e.FIREFOX="Firefox",e.QUPZILLA="QupZilla",e.TIZEN="Tizen",e.BADA="Bada",e.WEBOS_BROWSER="WebOS Browser",e.BLACKBERRY="BlackBerry",e.SLIMERJS="SlimerJS",e.PHANTOMJS="PhantomJS",e.AMAZON_SILK="Amazon Silk",e.SAILFISH="Sailfish",e.SEAMONKEY="SeaMonkey",e.VIVALDI="Vivaldi",e.MICROSOFT_EDGE="Microsoft Edge",e.INTERNET_EXPLORER="Internet Explorer",e.WECHAT="WeChat",e.K_MELEON="K-Meleon",e.SLEIPNIR="Sleipnir",e.PUFFIN="Puffin",e.EPIPHANY="Epiphany",e.MAXTHON="Maxthon",e.UC_BROWSER="UC Browser",e.YANDEX_BROWSER="Yandex Browser",e.OPERA_COAST="Opera Coast",e.SWING="Swing",e.FOCUS="Focus",e.MZ_BROWSER="MZ Browser",e.NAVER_WHALE_BROWSER="NAVER Whale Browser",e.SAMSUNG_INTERNET_FOR_ANDROID="Samsung Internet for Android",e.OPERA_TOUCH="Opera Touch",e.OPERA="Opera",e.GOOGLEBOT="Googlebot",e.WINDOWS_PHONE="windows phone",e.GENERIC="Generic",e.ROKU="Roku",e}(C||{}),L=function(e){return e.YANDEX="Yandex",e.GOOGLE="Google",e.APPLE="Apple",e.FACEBOOK="Facebook",e.VK="VK",e.OK="OK",e.AVITO="Avito",e.INSTAGRAM="Instagram",e.GOSUSLUGI="GosUslugi",e.MAILRU="Mail.ru",e.LOCAL="Local",e.MYMOSCOW="MyMoscow",e}(L||{}),_=function(e){return e.WEB="Web",e.ANDROID_MWEB="Android mWeb",e.IOS_MWEB="iOS mWeb",e.SMART_TV="smart tv",e}(_||{}),S="Facebook Messenger",E="Facebook",x="Twitter",A="Line",O="Wechat",U="Instagram",I="Electron Application",T="Microsoft Outlook",P="Pinterest App",R="Thunderbird",B="Webview Based Browser",D="Yandex App",N="Windows Phone",M="Windows",H="macOS",F="iOS",W="Android",j="WebOS",z="BlackBerry",V="Bada",G="Tizen",K="Linux",Z="Chrome OS",Y="PlayStation 4",q="Roku",Q="tablet",X="mobile",J="desktop",$="tv",ee=/version\/(\d+(\.?_?\d+)+)/i,te=function(e,t){var n=t.match(e);return n&&n.length>0&&n[1]||""},ne=function(e,t){var n=t.match(e);return n&&n.length>1&&n[2]||""},ie=[{test:[/googlebot/i],describe:function(e){var t={name:C.GOOGLEBOT},n=te(/googlebot\/(\d+(\.\d+))/i,e)||te(ee,e);return n&&(t.version=n),t}},{test:[/opera/i],describe:function(e){var t={name:C.OPERA},n=te(ee,e)||te(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:C.OPERA},n=te(/(?:opr|opios)[\s/](\S+)/i,e)||te(ee,e);return n&&(t.version=n),t}},{test:[/opt/i],describe:function(e){var t={name:C.OPERA_TOUCH},n=te(/(?:opt)[\s/](\S+)/i,e)||te(ee,e);return n&&(t.version=n),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:C.SAMSUNG_INTERNET_FOR_ANDROID},n=te(ee,e)||te(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Whale/i],describe:function(e){var t={name:C.NAVER_WHALE_BROWSER},n=te(ee,e)||te(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:C.MZ_BROWSER},n=te(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||te(ee,e);return n&&(t.version=n),t}},{test:[/focus/i],describe:function(e){var t={name:C.FOCUS},n=te(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||te(ee,e);return n&&(t.version=n),t}},{test:[/swing/i],describe:function(e){var t={name:C.SWING},n=te(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||te(ee,e);return n&&(t.version=n),t}},{test:[/coast/i],describe:function(e){var t={name:C.OPERA_COAST},n=te(ee,e)||te(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/yabrowser/i],describe:function(e){var t={name:C.YANDEX_BROWSER},n=te(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||te(ee,e);return n&&(t.version=n),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:C.UC_BROWSER},n=te(ee,e)||te(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:C.MAXTHON},n=te(ee,e)||te(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/epiphany/i],describe:function(e){var t={name:C.EPIPHANY},n=te(ee,e)||te(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/puffin/i],describe:function(e){var t={name:C.PUFFIN},n=te(ee,e)||te(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sleipnir/i],describe:function(e){var t={name:C.SLEIPNIR},n=te(ee,e)||te(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/k-meleon/i],describe:function(e){var t={name:C.K_MELEON},n=te(ee,e)||te(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/micromessenger/i],describe:function(e){var t={name:C.WECHAT},n=te(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||te(ee,e);return n&&(t.version=n),t}},{test:[/msie|trident/i],describe:function(e){var t={name:C.INTERNET_EXPLORER},n=te(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/\sedg\//i],describe:function(e){var t={name:C.MICROSOFT_EDGE},n=te(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:C.MICROSOFT_EDGE},n=ne(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/vivaldi/i],describe:function(e){var t={name:C.VIVALDI},n=te(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/seamonkey/i],describe:function(e){var t={name:C.SEAMONKEY},n=te(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sailfish/i],describe:function(e){var t={name:C.SAILFISH},n=te(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return n&&(t.version=n),t}},{test:[/silk/i],describe:function(e){var t={name:C.AMAZON_SILK},n=te(/silk\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/phantom/i],describe:function(e){var t={name:C.PHANTOMJS},n=te(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/slimerjs/i],describe:function(e){var t={name:C.SLIMERJS},n=te(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:C.BLACKBERRY},n=te(ee,e)||te(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:C.WEBOS_BROWSER},n=te(ee,e)||te(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/bada/i],describe:function(e){var t={name:C.BADA},n=te(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/tizen/i],describe:function(e){var t={name:C.TIZEN},n=te(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||te(ee,e);return n&&(t.version=n),t}},{test:[/qupzilla/i],describe:function(e){var t={name:C.QUPZILLA},n=te(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||te(ee,e);return n&&(t.version=n),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:C.FIREFOX},n=te(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/electron/i],describe:function(e){var t={name:C.ELECTRON},n=te(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/chromium/i],describe:function(e){var t={name:C.CHROMIUM},n=te(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||te(ee,e);return n&&(t.version=n),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:C.CHROME},n=te(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t={name:C.ANDROID_BROWSER},n=te(ee,e);return n&&(t.version=n),t}},{test:[/playstation 4/i],describe:function(e){var t={name:C.PLAYSTATION_4},n=te(ee,e);return n&&(t.version=n),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:C.SAFARI},n=te(ee,e);return n&&(t.version=n),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:te(t,e),version:ne(t,e)}}}],re=[{test:[/\bFB[\w_]+\/(Messenger|MESSENGER)/],describe:function(){return{name:S}}},{test:[/\bFB[\w_]+\//],describe:function(){return{name:E}}},{test:[/\bTwitter/i],describe:function(){return{name:x}}},{test:[/\bLine\//i],describe:function(){return{name:A}}},{test:[/\bMicroMessenger\//i],describe:function(){return{name:O}}},{test:[/\bInstagram/i],describe:function(){return{name:U}}},{test:[/\bElectron/i],describe:function(){return{name:I}}},{test:[/\bOutlook/i],describe:function(){return{name:T}}},{test:[/\bPinterest/i],describe:function(){return{name:P}}},{test:[/\bThunderbird/i],describe:function(){return{name:R}}},{test:[/\bwebview/i,/; wv/],describe:function(){return{name:B}}},{test:[/\bYaApp/i,/\bYandexSearch/i],describe:function(){return{name:D}}}],oe=[{test:[/Roku\/DVP/],describe:function(e){var t=te(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:q,version:t}}},{test:[/windows phone/i],describe:function(e){var t=te(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:N,version:t}}},{test:[/windows/i],describe:function(e){var t=te(/Windows ((NT|XP)( \d\d?.\d)?)/i,e);return{name:M,version:t}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:F},n=ne(/(Version\/)(\d[\d.]+)/,e);return n&&(t.version=n),t}},{test:[/macintosh/i],describe:function(e){var t=te(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,".");return{name:H,version:t}}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=te(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:F,version:t}}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t=te(/android[\s/-](\d+(\.\d+)*)/i,e);return{name:W,version:t}}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=te(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),n={name:j};return t&&(n.version=t),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=te(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||te(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||te(/\bbb(\d+)/i,e);return{name:z,version:t}}},{test:[/bada/i],describe:function(e){var t=te(/bada\/(\d+(\.\d+)*)/i,e);return{name:V,version:t}}},{test:[/tizen/i],describe:function(e){var t=te(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:G,version:t}}},{test:[/linux/i],describe:function(){return{name:K}}},{test:[/CrOS/],describe:function(){return{name:Z}}},{test:[/PlayStation 4/],describe:function(e){var t=te(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:Y,version:t}}}],se=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=te(/(can-l01)/i,e)&&"Nova",n={type:X,vendor:"Huawei",model:""};return t&&(n.model=t),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:Q,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:Q,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:Q,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:Q,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:Q,vendor:"Amazon"}}},{test:[/tablet/i],describe:function(){return{type:Q}}},{test:function(e){var t=e.test(/ipod|iphone/i),n=e.test(/like (ipod|iphone)/i);return t&&!n},describe:function(e){var t=te(/(ipod|iphone)/i,e);return{type:X,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:X,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:X}}},{test:function(e){return e.getBrowserName()===C.BLACKBERRY},describe:function(){return{type:X,vendor:"BlackBerry"}}},{test:function(e){return e.getBrowserName()===C.BADA},describe:function(){return{type:X}}},{test:function(e){return e.getBrowserName()===C.WINDOWS_PHONE},describe:function(){return{type:X,vendor:"Microsoft"}}},{test:function(e){var t,n=Number(null==(t=String(e.getOSVersion()))?void 0:t.split(".")[0]);return"android"===e.getOSName(!0)&&n>=3},describe:function(){return{type:Q}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:X}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:J,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:J}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:J}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:$}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:$}}}],ae=function(e){return String(e).toLowerCase()||""},ce=function(){function e(t){if(p(this,e),y(this,"ua"),y(this,"parsedResult"),!t)throw new Error("UserAgent parameter can't be empty ");this.ua=t,this.parsedResult={},this.parse()}return v(e,[{key:"getUA",value:function(){return this.ua}},{key:"test",value:function(e){return e.test(this.ua)}},{key:"getDetailInfo",value:function(e){var t=this;return e.find((function(e){if("function"==typeof e.test)return e.test(t);if(e.test instanceof Array)return e.test.some((function(e){return t.test(e)}));throw new Error("Browser's test function is not valid")}))}},{key:"parseBrowser",value:function(){this.parsedResult.browser={};var e=this.getDetailInfo(ie);return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}},{key:"getBrowser",value:function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}},{key:"getBrowserName",value:function(e){return e?ae(this.getBrowser().name):this.getBrowser().name||""}},{key:"getBrowserVersion",value:function(){return this.getBrowser().version}},{key:"parseOS",value:function(){this.parsedResult.os={};var e=this.getDetailInfo(oe);return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}},{key:"getOS",value:function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}},{key:"getOSName",value:function(e){var t=this.getOS().name;return e?ae(t):t||""}},{key:"getOSVersion",value:function(){return this.getOS().version}},{key:"parseApp",value:function(){this.parsedResult.app={};var e=this.getDetailInfo(re);return e&&(this.parsedResult.app=e.describe(this.getUA())),this.parsedResult.app}},{key:"getApp",value:function(){return this.parsedResult.app?this.parsedResult.app:this.parseApp()}},{key:"getAppName",value:function(e){return e?ae(this.getApp().name):this.getApp().name||""}},{key:"parsePlatform",value:function(){this.parsedResult.platform={};var e=this.getDetailInfo(se);return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}},{key:"getPlatform",value:function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}},{key:"getPlatformType",value:function(e){var t=this.getPlatform().type;return e?ae(t):t||""}},{key:"parse",value:function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseApp(),this}},{key:"getResult",value:function(){return h({},this.parsedResult)}}]),e}(),ue=function(){function e(){p(this,e)}return v(e,null,[{key:"getParser",value:function(e){if("string"!=typeof e)throw new Error("UserAgent should be a string");return new ce(e)}},{key:"parse",value:function(e){return new ce(e).getResult()}}]),e}(),le=function(){function e(){p(this,e),y(this,"browserMode","unknown")}return v(e,[{key:"retry",value:function(e){return new Promise((function(t){var n=0,i=!1,r=window.setInterval((function(){e()&&(window.clearInterval(r),t(i)),n++>50&&(window.clearInterval(r),t(i=!0))}),10)}))}},{key:"run",value:function(){var e=this;return new Promise((function(t){(new de).browser(e).detectBrowsingMode(),e.retry((function(){return"unknown"!==e.browserMode})).then((function(){t(e.browserMode)}))}))}}]),e}(),de=function(){function e(){p(this,e),y(this,"browserData")}return v(e,[{key:"browser",value:function(e){return this.browserData&&"object"==m(this.browserData)||(this.browserData=this.resolve(e)),this.browserData}},{key:"resolve",value:function(e){switch(ue.getParser(window.navigator.userAgent).getBrowserName()){case C.SAFARI:return new ge(e);case C.FIREFOX:return new fe(e);case C.INTERNET_EXPLORER:return new pe(e);default:return"webkitRequestFileSystem"in window||"requestFileSystem"in window?new he(e):window.PointerEvent||"MSPointerEvent"in window?new pe(e):new ve(e)}}}]),e}(),he=function(){function e(t){p(this,e),y(this,"navigator",navigator),y(this,"STORAGE_QUOTA_LIMIT",12e7),y(this,"TEMP_STORAGE_QUOTA_LIMIT",11e7),y(this,"BrowserModeDetector"),this.BrowserModeDetector=t}return v(e,[{key:"callbackWhenWebkitTemporaryStorageQuotaNotLimited",value:function(){this.BrowserModeDetector.browserMode="normal"}},{key:"callbackWhenWebkitTemporaryStorageQuotaLimited",value:function(){this.BrowserModeDetector.browserMode="incognito"}},{key:"callbackWhenWebkitStorageQuotaLimited",value:function(){this.BrowserModeDetector.browserMode="incognito"}},{key:"checkWebkitTemporaryStorageQuota",value:function(){var e=this;m(this.navigator.webkitTemporaryStorage)<"u"&&m(this.navigator.webkitTemporaryStorage.queryUsageAndQuota)<"u"?this.navigator.webkitTemporaryStorage.queryUsageAndQuota((function(t,n){n<e.TEMP_STORAGE_QUOTA_LIMIT?e.callbackWhenWebkitTemporaryStorageQuotaLimited():e.callbackWhenWebkitTemporaryStorageQuotaNotLimited()}),(function(){e.callbackWhenWebkitTemporaryStorageQuotaNotLimited()})):this.callbackWhenWebkitTemporaryStorageQuotaNotLimited()}},{key:"checkStorageQuota",value:function(){var e=this;m(navigator.storage)<"u"&&m(navigator.storage.estimate)<"u"?navigator.storage.estimate().then((function(t){null!=t&&t.quota&&(null==t?void 0:t.quota)<e.STORAGE_QUOTA_LIMIT?e.callbackWhenWebkitStorageQuotaLimited():e.callbackWhenWebkitStorageQuotaNotLimited()})):this.callbackWhenWebkitStorageQuotaNotLimited()}},{key:"callbackWhenWebkitStorageQuotaNotLimited",value:function(){this.checkWebkitTemporaryStorageQuota()}},{key:"detectBrowsingMode",value:function(){this.checkStorageQuota()}}]),e}(),fe=function(){function e(t){p(this,e),y(this,"db"),y(this,"BrowserModeDetector"),this.BrowserModeDetector=t}return v(e,[{key:"callbackWhenIndexedDBNotWorking",value:function(){this.BrowserModeDetector.browserMode="incognito"}},{key:"callbackWhenIndexedDBWorking",value:function(){var e=this;"unknown"===this.BrowserModeDetector.browserMode&&this.BrowserModeDetector.retry((function(){return"done"===e.db.readyState})).then((function(t){if(t)return e.callbackWhenIndexedDBNotWorking();e.db.result&&(e.BrowserModeDetector.browserMode="normal")}))}},{key:"detectBrowsingMode",value:function(){this.db=indexedDB.open("i"),this.db.onsuccess=this.callbackWhenIndexedDBWorking.bind(this),this.db.onerror=this.callbackWhenIndexedDBNotWorking.bind(this)}}]),e}(),pe=function(){function e(t){p(this,e),y(this,"BrowserModeDetector"),this.BrowserModeDetector=t}return v(e,[{key:"detectBrowsingMode",value:function(){this.BrowserModeDetector.browserMode="normal";try{window.indexedDB||(this.BrowserModeDetector.browserMode="incognito")}catch(e){this.BrowserModeDetector.browserMode="incognito"}}}]),e}(),ge=function(){function e(t){p(this,e),y(this,"BrowserModeDetector"),this.BrowserModeDetector=t}return v(e,[{key:"tryFillLocalStorage",value:function(e){var t={size:e,payload:new Array(e/4+1).join("aあ"),lastModifiedDate:new Date,name:1e5+~~(1e5*Math.random())+".txt"};try{localStorage.setItem(t.name,JSON.stringify(t))}catch(e){try{localStorage.removeItem(t.name)}catch(e){}return!1}try{localStorage.removeItem(t.name)}catch(e){}return!0}},{key:"detectBrowsingMode",value:function(){var e,t,n=window,i=ue.getParser(window.navigator.userAgent),r=parseInt(null==(e=i.getOSVersion())?void 0:e.split(".")[0],10)||0,o=parseInt(null==(t=i.getBrowserVersion())?void 0:t.split(".")[0],10)||0,s=i.getOSName(!0);if(!n.safariIncognito&&navigator.cookieEnabled){try{n.openDatabase&&n.openDatabase(null,null,null,null),n.localStorage.setItem("test","1")}catch(e){this.BrowserModeDetector.browserMode="incognito"}"unknown"===this.BrowserModeDetector.browserMode&&(n.localStorage.removeItem("test"),"ios"===s&&r>=14||"macos"===s&&o>=14||"ios"===s&&0===o?this.BrowserModeDetector.browserMode="normal":this.tryFillLocalStorage(5242880)?this.BrowserModeDetector.browserMode="incognito":this.BrowserModeDetector.browserMode="normal")}else this.BrowserModeDetector.browserMode="incognito"}}]),e}(),ve=function(){function e(t){p(this,e),y(this,"BrowserModeDetector"),this.BrowserModeDetector=t}return v(e,[{key:"detectBrowsingMode",value:function(){this.BrowserModeDetector.browserMode="normal"}}]),e}(),be="mobile"===ue.getParser(window.navigator.userAgent).getPlatformType(!0),me=ue.getParser(window.navigator.userAgent).getOSName(!0),we=function(){var e=document.createElement("div");return e.innerHTML='<div class="sbid-certificate-template-title '.concat(be?"":"sbid-certificate-template-title-web",'">\n                        ').concat(be?"В этом браузере не нашли нужные сертификаты. Где продолжим?":"Как продолжим?","\n                        </div>"),be||(e.innerHTML+='<div class="sbid-certificate-template-title-description-text sbid-certificate-template-title-indent-30">\n                            '.concat("В этом браузере мы не нашли нужные сертификаты. Что можно сделать:","</div>")),e},ye=function(){var e=document.createElement("div");return e.innerHTML='\n    <div class="sbid-certificate-template-divider">\n        <span class="sbid-certificate-template-divider-label">или</span>\n    </div>',e},ke=function(){var e=document.createElement("div");return e.tabIndex=0,e.title="Закрыть",e.innerHTML='<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g id="Icon">\n<rect width="32" height="32" rx="8" fill="#080808" fill-opacity="0.02"/>\n<g id="24 Universal / ds_ic_24_cross_small">\n<path id="Shape" fill-rule="evenodd" clip-rule="evenodd" d="M20.7071 11.2929C21.0976 11.6834 21.0976 12.3166 20.7071 12.7071L17.4142 16L20.7071 19.2929C21.0976 19.6834 21.0976 20.3166 20.7071 20.7071C20.3166 21.0976 19.6834 21.0976 19.2929 20.7071L16 17.4142L12.7071 20.7071C12.3166 21.0976 11.6834 21.0976 11.2929 20.7071C10.9024 20.3166 10.9024 19.6834 11.2929 19.2929L14.5858 16L11.2929 12.7071C10.9024 12.3166 10.9024 11.6834 11.2929 11.2929C11.6834 10.9024 12.3166 10.9024 12.7071 11.2929L16 14.5858L19.2929 11.2929C19.6834 10.9024 20.3166 10.9024 20.7071 11.2929Z" fill="#080808"/>\n</g>\n</g>\n</svg>',e.classList.add("sbid-certificate-template-close"),e},Ce=function(){var e=document.createElement("a");return e.classList.add("sbid-certificate-template-link"),e.innerText="Установить сертификаты",e.href="http://www.sberbank.ru/ru/certificates",e},Le=function(e,t,n,i,r,o){var s=document.createElement("div");s.classList.add("sbid-certificate-template-open-in-browser"),o&&s.classList.add(o);var a=Se(e),c=document.createElement("div");c.innerText=t,c.classList.add("sbid-certificate-template-open-in-browser-label");var u=_e();return s.appendChild(a),s.appendChild(c),be?(s.onclick=function(){var e=window.location.href||"about:blank";window.location.href="ios"===me&&r?r+e:"android"===me?"intent://"+e.replace(/https?:\/\//,"")+"#Intent;scheme=https;package="+i+";end":n},s.appendChild(u)):s.onclick=function(){window.location.href=n},s},_e=function(){var e=document.createElement("div");return e.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g id="ds_ic_24_chevron_right">\n<path id="Path" fill-rule="evenodd" clip-rule="evenodd" d="M9.88289 8.70711C9.49237 8.31658 9.49237 7.68342 9.88289 7.29289C10.2734 6.90237 10.9066 6.90237 11.2971 7.29289L16.0042 12L11.2971 16.7071C10.9066 17.0976 10.2734 17.0976 9.88289 16.7071C9.49237 16.3166 9.49237 15.6834 9.88289 15.2929L13.1758 12L9.88289 8.70711Z" fill="#080808" fill-opacity="0.5"/>\n</g>\n</svg>',e},Se=function(e){var t=document.createElement("div");t.classList.add("sbid-certificate-template-icon");var n=document.createElement("div");return n.classList.add(e),n.classList.add("sbid-certificate-template-icon-wrap"),t.appendChild(n),t},Ee=function(){var e=document.createElement("div");return e.innerHTML='\n    <div class="sbid-certificate-template-title-description-text sbid-certificate-template-title-indent-10">'.concat("Шаг 1 — скопируйте ссылку",'</div>\n    <div class="sbid-certificate-template-step-link-container sbid-certificate-template-title-indent-20" >\n        <div class="sbid-certificate-template-step-link-box">\n            <div class="sbid-certificate-template-step-link-label">').concat("Ссылка",'</div>\n            <input disabled value="').concat(window.location.href,'" class="sbid-certificate-template-open-in-browser-label sbid-certificate-template-link-input"></input>\n            <div class="sbid-certificate-template-copy-hint" id="sbid-certificate-template-copy-hint-text"></div>\n        </div>\n        <div class="sbid-certificate-template-cursor-pointer" role="button" tabindex="0" title="Cкопировать ссылку" id="sbid-copy-in-buffer-button">\n            <svg width="19" height="16" viewBox="0 0 19 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n            <path d="M2 12C0.895431 12 3.97973e-07 11.1046 3.49691e-07 10L0 2C-4.82823e-08 0.895431 0.89543 5.29108e-07 2 4.80826e-07L13 0C14.1046 -4.82818e-08 15 0.895431 15 2V10C15 11.1046 14.1046 12 13 12L2 12Z" fill="#148F2B"/>\n            <path fill-rule="evenodd" clip-rule="evenodd" d="M17 4V5C17 5.55228 17.4477 6 18 6C18.5523 6 19 5.55228 19 5V4C19 3.44771 18.5523 3 18 3C17.4477 3 17 3.44771 17 4Z" fill="#148F2B"/>\n            <path fill-rule="evenodd" clip-rule="evenodd" d="M17 8.59082V10.3868C17 10.9391 17.4477 11.3868 18 11.3868C18.5523 11.3868 19 10.9391 19 10.3868V8.59082C19 8.03854 18.5523 7.59082 18 7.59082C17.4477 7.59082 17 8.03854 17 8.59082Z" fill="#148F2B"/>\n            <path fill-rule="evenodd" clip-rule="evenodd" d="M16.8814 13.4733C16.7505 13.7159 16.5252 13.8942 16.2617 13.9654L16.1466 13.9892C15.6001 14.0688 15.2215 14.5763 15.3011 15.1228C15.3806 15.6693 15.8881 16.0479 16.4347 15.9684C17.3771 15.8312 18.1935 15.2532 18.6415 14.4231C18.9038 13.9371 18.7224 13.3305 18.2364 13.0682C17.7851 12.8246 17.2298 12.9636 16.9427 13.3738L16.8814 13.4733Z" fill="#148F2B"/>\n            <path fill-rule="evenodd" clip-rule="evenodd" d="M12.6964 13.9998H10.9004C10.3481 13.9998 9.90039 14.4475 9.90039 14.9998C9.90039 15.552 10.3481 15.9998 10.9004 15.9998H12.6964C13.2487 15.9998 13.6964 15.552 13.6964 14.9998C13.6964 14.4475 13.2487 13.9998 12.6964 13.9998Z" fill="#148F2B"/>\n            <path fill-rule="evenodd" clip-rule="evenodd" d="M7.30967 13.9998H5.51367C4.96139 13.9998 4.51367 14.4475 4.51367 14.9998C4.51367 15.552 4.96139 15.9998 5.51367 15.9998H7.30967C7.86196 15.9998 8.30967 15.552 8.30967 14.9998C8.30967 14.4475 7.86196 13.9998 7.30967 13.9998Z" fill="#148F2B"/>\n            </svg>\n        </div>\n    </div>\n    <div class="sbid-certificate-template-title-description-text sbid-certificate-template-title-indent-10">').concat("Шаг 2 — откройте её в одном из браузеров","</div>\n    "),e},xe="mobile"===ue.getParser(window.navigator.userAgent).getPlatformType(!0),Ae=function(){function e(){p(this,e),y(this,"banner",null),y(this,"closed",!1)}return v(e,[{key:"create",value:function(){var e=this,t=document.getElementsByTagName("body")[0],n=document.createElement("div");n.classList.add("sbid-certificate-banner_overlay"),xe||n.classList.add("sbid-certificate-banner_overlay-web");var i=function(e){var t=document.createElement("div");t.classList.add(be?"sbid-certificate-template":"sbid-certificate-template-web");var n=document.createElement("div");n.classList.add("sbid-certificate-template-header");var i=we(),r=ke();r.onclick=e,n.appendChild(i),n.appendChild(r);var o=document.createElement("div");be||o.classList.add("sbid-certificate-template-browser-list-web");var s=Ee(),a=Ce(),c=Le("sbid-certificate-template-icon-ya","Яндекс Браузер","https://browser.yandex.ru/","com.yandex.browser","yandexbrowser-open-url://");if(o.appendChild(c),"ios"!==me){var u=Le("sbid-certificate-template-icon-atom","Atom","https://browser.ru/","ru.mail.browser",null,be?"":"sbid-certificate-template-second-browser");o.appendChild(u)}var l=ye();return t.appendChild(n),be||t.appendChild(s),t.appendChild(o),t.appendChild(l),t.appendChild(a),t}((function(){return e.hide()}));n.appendChild(i),t.appendChild(n),this.banner=n;var r=document.getElementById("sbid-copy-in-buffer-button"),o=document.getElementById("sbid-certificate-template-copy-hint-text");r&&(r.onclick=function(){setTimeout((function(){o&&(o.innerHTML="",o.classList.remove("sbid-certificate-template-color-error"),o.classList.remove("sbid-certificate-template-color-success"))}),3e3),navigator.clipboard?navigator.clipboard.writeText(window.location.href).then((function(){o&&(o.classList.add("sbid-certificate-template-color-success"),o.innerHTML="Скопировано")}),(function(){o&&(o.classList.add("sbid-certificate-template-color-error"),o.innerHTML="Не удалось скопировать")})):o&&(o.classList.add("sbid-certificate-template-color-error"),o.innerHTML="Не удалось скопировать")}),window.addEventListener("click",this.outsideClick.bind(this))}},{key:"outsideClick",value:function(e){e.target==this.banner&&(this.hide(),window.removeEventListener("click",this.outsideClick))}},{key:"show",value:function(){this.create()}},{key:"hide",value:function(){this.banner&&(this.banner.remove(),this.banner=null,this.closed=!0)}}]),e}(),Oe="https://online.sberbank.ru",Ue="sberbankidlogin://sberbankidsso",Ie=1e4,Te="/CSAFront/api/oidc/sbid",Pe="/CSAFront/api/oidc/reset",Re="/CSAFront/oidc/authorizelow.do",Be=function(){return"".concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oe,"/CSAFront/oidc/authorize.do")},De=function(){return"".concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oe,"/CSAFront/oidc/sberbank_id/authorize.do")};function Ne(e,t){return t=t||{},new Promise((function(n,i){var r=new XMLHttpRequest,o=[],s=[],a={},c=function e(){return{ok:2==(r.status/100|0),statusText:r.statusText,status:r.status,url:r.responseURL,text:function(){return Promise.resolve(r.responseText)},json:function(){return Promise.resolve(r.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([r.response]))},clone:e,headers:{keys:function(){return o},entries:function(){return s},get:function(e){return a[e.toLowerCase()]},has:function(e){return e.toLowerCase()in a}}}};for(var u in r.open(t.method||"get",e,!0),r.onload=function(){r.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(e,t,n){o.push(t=t.toLowerCase()),s.push([t,n]),a[t]=a[t]?a[t]+","+n:n})),n(c())},r.onerror=i,r.withCredentials="include"==t.credentials,t.headers)r.setRequestHeader(u,t.headers[u]);r.send(t.body||null)}))}var Me=function(){var e=l(c().mark((function e(t,n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ne(t,n).then(function(){var e=l(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=2;break}return e.abrupt("return",{success:!1});case 2:return e.prev=2,e.next=5,t.json();case 5:n=e.sent,e.next=10;break;case 8:e.prev=8,e.t0=e.catch(2);case 10:return e.prev=10,e.finish(10);case 12:return e.abrupt("return",{success:!0,data:n});case 13:case"end":return e.stop()}}),e,null,[[2,8,10,12]])})));return function(t){return e.apply(this,arguments)}}()).catch((function(){return{success:!1}}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),He=function(){var e=l(c().mark((function e(t,n,i){var r,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new AbortController,n.signal=r.signal,e.abrupt("return",Promise.race([Me(t,n),new Promise((function(e,n){o=setTimeout((function(){r.abort();var e={success:!1,error:{description:"Ошибка при выполнении запроса ".concat(t),code:"request_fail"}};n(e)}),i)}))]).finally((function(){clearTimeout(o)})));case 3:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),Fe={method:"GET",credentials:"include"},We=v((function e(){var t=this;return p(this,e),y(this,"cache",{}),y(this,"set",(function(e,n){t.cache[e]={data:n}})),y(this,"get",(function(e){var n=t.cache[e];return new Promise(n?function(e){return e(n.data)}:function(e){return e(void 0)})})),y(this,"remove",(function(e){delete t.cache[e]})),y(this,"clear",(function(){t.cache={}})),y(this,"all",(function(){return Object.keys(t.cache)})),e.instance?e.instance:(e.instance=this,this)}));y(We,"instance");var je,ze=We,Ve=(f(e={},C.AMAZON_SILK,"amazon_silk"),f(e,C.ANDROID_BROWSER,"android"),f(e,C.BADA,"bada"),f(e,C.BLACKBERRY,"blackberry"),f(e,C.CHROME,"chrome"),f(e,C.CHROMIUM,"chromium"),f(e,C.ELECTRON,"electron"),f(e,C.EPIPHANY,"epiphany"),f(e,C.FIREFOX,"firefox"),f(e,C.FOCUS,"focus"),f(e,C.GENERIC,"generic"),f(e,C.GOOGLEBOT,"googlebot"),f(e,C.INTERNET_EXPLORER,"ie"),f(e,C.K_MELEON,"k_meleon"),f(e,C.MAXTHON,"maxthon"),f(e,C.MICROSOFT_EDGE,"edge"),f(e,C.MZ_BROWSER,"mz"),f(e,C.NAVER_WHALE_BROWSER,"naver"),f(e,C.OPERA,"opera"),f(e,C.OPERA_COAST,"opera_coast"),f(e,C.OPERA_TOUCH,"opera_touch"),f(e,C.PHANTOMJS,"phantomjs"),f(e,C.PUFFIN,"puffin"),f(e,C.QUPZILLA,"qupzilla"),f(e,C.SAFARI,"safari"),f(e,C.SAILFISH,"sailfish"),f(e,C.SAMSUNG_INTERNET_FOR_ANDROID,"samsung_internet"),f(e,C.SEAMONKEY,"seamonkey"),f(e,C.SLEIPNIR,"sleipnir"),f(e,C.SWING,"swing"),f(e,C.TIZEN,"tizen"),f(e,C.UC_BROWSER,"uc"),f(e,C.VIVALDI,"vivaldi"),f(e,C.WEBOS_BROWSER,"webos"),f(e,C.WECHAT,"wechat"),f(e,C.YANDEX_BROWSER,"yandex"),f(e,C.ROKU,"roku"),e),Ge=["chrome","yandex","firefox","samsung_internet","opera","opera_touch"],Ke=function(e){return e.ANDROID="android",e.IOS="ios",e}(Ke||{}),Ze=function(e){return e.HTTP="http",e.HTTPS="https",e}(Ze||{}),Ye={android:{chrome:"com.android.chrome",yandex:"com.yandex.browser",opera:"com.opera.browser",firefox:"org.mozilla.firefox",samsung_internet:"com.sec.android.app.sbrowser"},ios:{chrome:{https:"googlechromes://",http:"googlechrome://"},yandex:{https:"yandexbrowser-open-url://https://",http:"yandexbrowser-open-url://http://"},opera_touch:{https:"touch-https://",http:"touch-http://"},firefox:{https:"firefox://open-url%3Furl%3Dhttps%3A%2F%2F",http:"firefox://open-url%3Furl%3Dhttp%3A%2F%2F"}}},qe={needAdditionalRedirect:!0,universalLinkUrl:"",baseUrl:"",deeplinkUrl:Ue,debug:!1,generateState:!1,display:"page"},Qe={enable:!1,debug:!1,mode:"default",timeout:1500,baseUrl:Oe,pathUrl:Re,onErrorAutoMode:function(){},onErrorDefaultMode:function(){return!0},logUid:""},Xe={invalid_request:"В запросе отсутствуют обязательные атрибуты",unauthorized_client:"АС - источник запроса не зарегистрирована или заблокирована в банке либо значение атрибута client_id не соответствует формату",unsupported_response_type:"Значение атрибута response_type не равно «code»",invalid_scope:"Значение атрибута scope не содержит параметр openid в начальной позиции либо запрошенный scope содержит значения, недоступные для АС - источника запроса",access_denied:"Клиент отказался от передачи согласий",invalid_state:"Значение атрибута state не соответствует изначальному",window_closed:"Клиент закрыл окно авторизации через Сбер ID"},Je="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",$e={enable:!1,getUserUrl:"/CSAFront/api/userdata",changeUserUrl:"/CSAFront/api/changeuser",baseUrl:"https://id.sber.ru",iframeUrl:"/oidc/authorizelow"},et={baseUrl:Oe,oidc:{oidcReferrer:("undefined"==typeof location?"undefined":m(location))<"u"?location.origin:"",channel:"browser",logUid:""},fastLogin:Qe,personalization:!0,display:"page",universalLink:qe,deeplink:{enable:!1,allowSberIDRedirects:[],mode:"default"},cloud:$e},tt={landing:"http://id.sber.ru/landing/certificates.html",checker:"https://oauth.sber.ru/",enable:!1,showBanner:!0},nt=new Uint8Array(16);function it(){if(!je&&!(je=("undefined"==typeof crypto?"undefined":m(crypto))<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||("undefined"==typeof msCrypto?"undefined":m(msCrypto))<"u"&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return je(nt)}var rt=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var ot=[],st=0;st<256;++st)ot.push((st+256).toString(16).substr(1));function at(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(ot[e[t+0]]+ot[e[t+1]]+ot[e[t+2]]+ot[e[t+3]]+"-"+ot[e[t+4]]+ot[e[t+5]]+"-"+ot[e[t+6]]+ot[e[t+7]]+"-"+ot[e[t+8]]+ot[e[t+9]]+"-"+ot[e[t+10]]+ot[e[t+11]]+ot[e[t+12]]+ot[e[t+13]]+ot[e[t+14]]+ot[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&rt.test(e)}(n))throw TypeError("Stringified UUID is invalid");return n}function ct(e,t,n){var i=(e=e||{}).random||(e.rng||it)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(var r=0;r<16;++r)t[n+r]=i[r];return t}return at(i)}var ut=function(){return"3.6.0"},lt=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null==(e=window.location.search)?void 0:e.slice(1);return t?(/^[?#]/.test(t)?t.slice(1):t).split("&").reduce((function(e,t){var n=o(t.split("="),2),i=n[0],r=n[1];return e[i]=r?decodeURIComponent(r.replace(/\+/g," ")):"",e}),{}):{}},dt=function(e,t){var n=Object.keys(t).map((function(e){return[e,t[e]].map(encodeURIComponent).join("=")})).join("&");return e?"".concat(e).concat(n?"?":"").concat(n):n},ht={info:{color:"#0c5460",background:"#d1ecf1",border:"#bee5eb"},success:{color:"#155724",background:"#d4edda",border:"#c3e6cb"},error:{color:"#721c24",background:"#f8d7da",border:"#f5c6cb"}},ft=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=new Date,i="[".concat(n.getHours(),":").concat(n.getMinutes(),":").concat(n.getSeconds().toString().padStart(2,"0"),":").concat(n.getMilliseconds(),"] %c[").concat(t,"]%c "),r="color: ".concat(ht[t].color,";background-color: ").concat(ht[t].background,";border: 1px solid ").concat(ht[t].border);console.info.apply(null,[i,r,""].concat(e))},pt=function(e,t){var n=function(n){!e.contains(n.target)&&gt(e)&&(t(),i())},i=function(){document.removeEventListener("click",n)};document.addEventListener("click",n)},gt=function(e){return!!e&&!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},vt=function(){var e=null==document?void 0:document.querySelectorAll(".sbid-button-loader");document.querySelectorAll(".sbid-button").forEach((function(e){null==e||e.setAttribute("loading","loading")}));for(var t=0;t<(null==e?void 0:e.length);t+=1)e[t].classList.add("sbid-button-loader--show")},bt=function(){var e=null==document?void 0:document.querySelectorAll(".sbid-button-loader");document.querySelectorAll(".sbid-button").forEach((function(e){null==e||e.removeAttribute("loading")}));for(var t=0;t<(null==e?void 0:e.length);t+=1)e[t].classList.remove("sbid-button-loader--show")},mt=function(){var e=lt();if(window.opener&&(e.code||e.error)){var t=h({status:"success"},e);t.error&&(t.status="error",t.description="string"==typeof t.code?Xe[t.code]||"Что-то пошло не так":"");try{window.opener.postMessage(JSON.stringify(Object.assign(t,e)),window.opener.location.href)}catch(e){ft(["Ошибка при отправке сообщения из окна авторизации по Сбер ID",e],"error")}}},wt=function e(t,n){return Object.keys(h(h({},t),n)).reduce((function(i,r){return"object"!=m(t[r])||Array.isArray(t[r])?h(h({},i),{},f({},r,null!=n&&n.hasOwnProperty(r)?n[r]:t[r])):h(h({},i),{},f({},r,"object"==m(n[r])?e(t[r],n[r]):null!=n&&n.hasOwnProperty(r)?n[r]:t[r]))}),{})},yt=function(){return window.crypto||window.msCrypto},kt=function(e){var t=new Uint8Array(e);if(("undefined"==typeof window?"undefined":m(window))<"u"&&yt())yt().getRandomValues(t);else for(var n=0;n<e;n+=1)t[n]=62*Math.random()|0;return function(e){for(var t=[],n=0;n<e.byteLength;n+=1){var i=e[n]%62;t.push(Je[i])}return t.join("")}(t)},Ct=function(e){switch(e){case"android":return _.ANDROID_MWEB;case"ios":return _.IOS_MWEB;case"roku":case"playstation 4":return _.SMART_TV;default:return _.WEB}},Lt=function(){return ct().replace(/-/g,"")},_t=function(e){var t=function(t){var n;try{n=JSON.parse(t.data)}catch(e){return}e(n,t)};return window.addEventListener("message",t),function(){return window.removeEventListener("message",t)}},St=function(e,t){!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"*";t&&t.postMessage(JSON.stringify(e),n)}(e,t)},Et=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sberid-iframe",n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=document.createElement("iframe");return r.setAttribute("src",e),r.setAttribute("frameborder","0"),r.setAttribute("name",t),r.setAttribute("id",t),r.referrerPolicy="origin",r.width="0",r.height="0",r.style.display="none",r.style.position="absolute",r.style.left="-9999px","function"==typeof n&&(r.onload=n),"function"==typeof i&&(r.onerror=i),r},xt=function(){function e(){if(p(this,e),y(this,"config",{baseUrl:Oe,getUserUrl:Te,changeUserUrl:Pe,iframeUrlPath:void 0,oidcParams:void 0,debug:!1,addProcessId:!1,clientId:"",logUid:""}),y(this,"cache",new ze),y(this,"listeners",[]),e.instance)throw new Error("Error: Instantiation failed: Use UserHelper.getInstance() instead of new.");e.instance=this}var t,n,i;return v(e,[{key:"setConfig",value:function(e){this.config=wt(this.config,e),this.config.debug&&ft(["Установка конфига UserHelper",this.config],"info")}},{key:"setListener",value:function(e){this.listeners.push(e)}},{key:"callListeners",value:function(e){for(var t=0;t<this.listeners.length;t+=1)this.listeners[t].call(this,e)}},{key:"_getUser",value:(i=l(c().mark((function e(){var t,n,i,r,o=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(o.length>0&&void 0!==o[0])||o[0],this.config.baseUrl&&this.config.clientId){e.next=4;break}return this.config.debug&&(!this.config.baseUrl&&ft(["Ошибка при получении данных о пользователе, отсутствует baseUrl"],"error"),!this.config.clientId&&ft(["Ошибка при получении данных о пользователе, отсутствует clientId"],"error")),e.abrupt("return");case 4:return n="".concat(this.config.baseUrl).concat(this.config.getUserUrl,"?client_id=").concat(this.config.clientId),e.next=7,this.cache.get("user");case 7:if(i=e.sent,t||!i){e.next=10;break}return e.abrupt("return",i);case 10:return e.next=12,He(n,h(h({},Fe),{},{headers:h({},this.config.addProcessId?{"Process-ID":this.config.logUid,"x-subject":this.config.clientId}:{})}),Ie);case 12:if((r=e.sent).success&&(i=r.data),!i){e.next=15;break}return e.abrupt("return",(this.cache.set("user",i),this.callListeners(i),i));case 15:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"getUser",value:(n=l(c().mark((function e(){var t,n,i,r,o,s=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]&&s[0],e.next=3,this.cache.get("user");case 3:if(!(n=e.sent)||t){e.next=6;break}return e.abrupt("return",(this.callListeners(n),n));case 6:if(!this.config.iframeUrlPath||!this.config.oidcParams){e.next=25;break}return this.config.debug&&ft(["UserHelper получение через iframe",this.config],"info"),i=null,e.prev=9,r=dt("".concat(this.config.baseUrl).concat(this.config.iframeUrlPath),h(h({},this.config.oidcParams),{},{logUid:this.config.logUid})),i=Et(r,void 0,void 0,void 0),document.body.append(i),e.next=14,new Promise((function(e,t){var n=setTimeout((function(){r(),t({success:!1,error:{type:"timeout",description:"Ошибка при создании UserHelper iframe"}})}),3e3),r=_t((function(o){"iframe is registered"===o.type&&St({type:"fetch user"},i.contentWindow),"success user"===o.type&&(e(o.data),r(),clearTimeout(n)),"error user"===o.type&&(t(o.data),r(),clearTimeout(n))}))}));case 14:if(!(o=e.sent)){e.next=17;break}return e.abrupt("return",(this.cache.set("user",o),this.callListeners(o),o));case 17:null==i||i.remove(),e.next=23;break;case 20:return e.prev=20,e.t0=e.catch(9),e.abrupt("return",(this.config.debug&&ft(["UserHelper получение через iframe неудача, получение через запрос",this.config],"info"),null==i||i.remove(),this._getUser()));case 23:e.next=26;break;case 25:return e.abrupt("return",(this.config.debug&&ft(["UserHelper получение через запрос",this.config],"info"),this._getUser()));case 26:case"end":return e.stop()}}),e,this,[[9,20]])}))),function(){return n.apply(this,arguments)})},{key:"resetUser",value:(t=l(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.config.baseUrl&&this.config.clientId){e.next=2;break}return e.abrupt("return",!1);case 2:return t="".concat(this.config.baseUrl).concat(this.config.changeUserUrl,"?client_id=").concat(this.config.clientId),e.next=5,He(t,h(h({},Fe),{},{headers:h({},this.config.addProcessId?{"Process-ID":this.config.logUid,"x-subject":this.config.clientId}:{})}),Ie);case 5:if(!e.sent.success){e.next=9;break}e.t0=(this.cache.remove("user"),this.callListeners(),!0),e.next=10;break;case 9:e.t0=!1;case 10:return e.abrupt("return",e.t0);case 11:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}],[{key:"getInstance",value:function(){return e.instance}}]),e}();y(xt,"instance",new xt);var At,Ot,Ut=xt,It={getRandomValues:function(e){for(var t=new Uint8Array(r(e)),n=0;n<t.length;n+=1)t[n]=Math.floor(256*Math.random());return t}},Tt=window.crypto||window.msCrypto||It,Pt=function(e){var t=Number(e);return(t^Number(Tt.getRandomValues(new Uint8Array(1))[0])&15>>t/4).toString(16)},Rt="_sa",Bt="_sas",Dt=function(){return Math.floor((new Date).getTime()/1e3)},Nt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:365,i=["".concat(e,"=").concat(t||""),"samesite=strict","path=/"];if("production"===process.env.NODE_ENV&&(i.push("domain=.".concat(function(){var e=window.location.hostname.split(".");return e.length>=2?e.slice(-2).join("."):window.location.hostname}())),i.push("secure")),n){var r=new Date;r.setTime(r.getTime()+864e5*n),i.push("expires=".concat(r.toUTCString()))}document.cookie=i.join(";")},Mt=function(e){var t=new RegExp("(^|[^;]+)\\s*".concat(e,"\\s*=\\s*([^;]+)")).exec(document.cookie);return t?t[2]:void 0},Ht=function(){var e=Mt(Rt);if(!e){var t="10000000-1000-4000-8000-100000000000".replace(/[018]/g,Pt),n="".concat("SA").concat("1",".").concat(t,".").concat(String(Dt()));return Nt(Rt,n),n}return e};try{Ht()}catch(e){Ot=e}var Ft="",Wt=function(){return Ft?"".concat(Bt,"_").concat(Ft):Bt},jt=function(){return Mt(Rt)},zt=function(){return Mt(Wt())},Vt=function(e){return e<10?"0".concat(e):e},Gt=function(){var e=new Date,t=new Date(e.valueOf()-6e4*e.getTimezoneOffset()),n=o(t.toISOString().split("Z"),1)[0];return"".concat(n).concat(function(e){return"".concat(e<0?"+":"-").concat(Vt(Math.abs(e/60)),":").concat(Vt(Math.abs(e%60)))}(t.getTimezoneOffset()))},Kt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;return e.length>t?e.substring(0,t):e},Zt=[],Yt={url:"",buffer:10,credentials:!1},qt={},Qt={},Xt=function(e){Object.assign(Yt,e)},Jt=function(e){Object.assign(qt,e)},$t=function(e){Object.assign(Qt,h(h(h(h(h(h({},e),{},{clientBlock:Kt(e.clientBlock,64),hashUserLoginId:Kt(e.hashUserLoginId),appVersion:Kt(e.appVersion,16)},e.adId&&{adId:Kt(e.adId)}),e.appId&&{appId:Kt(e.appId)}),e.subId&&{subId:Kt(e.subId)}),e.sapId&&{sapId:Kt(e.sapId)}),e.partnerId&&{partnerId:Kt(e.partnerId)}))},en=function(e){Zt.push(e)},tn=function(){return Yt},nn=function(e){Zt.splice.apply(Zt,[0,0].concat(r(e)))},rn=function(){return Zt.length},on=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=new XMLHttpRequest;i.open("POST",e,!0),i.setRequestHeader("Content-type","application/json;charset=utf-8"),tn().credentials&&(i.withCredentials=!0),i.send(JSON.stringify(t)),i.onreadystatechange=function(){4===i.readyState&&i.status>=400&&n()}},sn=function(){return window.navigator.onLine},an={bluetooth:"BLUETOOTH",cellular:"CELLULAR",ethernet:"ETHERNET",wifi:"WIFI",mixed:"UNKNOWN",none:"UNKNOWN",wimax:"UNKNOWN",other:"UNKNOWN",unknown:"UNKNOWN"},cn=function(){var e,t;return an[null===(e=window.navigator)||void 0===e||null===(t=e.connection)||void 0===t?void 0:t.type]||"UNKNOWN"},un=function(){var e=l(c().mark((function e(){var t,n,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,null===(t=window.navigator)||void 0===t?void 0:t.getBattery();case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0={};case 6:return n=e.t0,i=n.level,e.abrupt("return","number"==typeof i?String(100*i):void 0);case 11:return e.prev=11,e.t1=e.catch(0),e.abrupt("return");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),ln=function(e){if(null!=e){var t=e.filter((function(e){return"string"==typeof e.value})).slice(0,128);return t.length?t.map((function(e){var t=e.key,n=e.value;return{key:Kt(t),value:Kt(n)}})):void 0}},dn=function(){return{meta:h(h({},qt),{},{platform:"WEB",screenSize:"".concat(window.screen.width,"x").concat(window.screen.height),browser:window.navigator.userAgent,systemLanguage:window.navigator.language||window.navigator.userLanguage||window.navigator.browserLanguage||window.navigator.systemLanguage,timeStamp:Gt()}),profile:h(h({},Qt),{},{applicationLanguage:Kt(document.documentElement.lang,16),deviceId:jt(),sessionId:zt()}),data:Zt.splice(0,Math.min(Zt.length,Yt.buffer))}},hn=function(){var e=l(c().mark((function e(t,n){var i,r,o,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=en,e.t1=Kt(t.eventCategory),e.t2=Kt(t.eventAction,1024),e.t3=n,e.t4=Kt(t.value),e.t5=ln(t.properties),e.next=8,un();case 8:if(e.t6=e.sent,e.t7=cn(),e.t8=Gt(),e.t9={eventCategory:e.t1,eventAction:e.t2,eventType:e.t3,value:e.t4,properties:e.t5,batteryLevel:e.t6,connectionType:e.t7,timeStamp:e.t8},(0,e.t0)(e.t9),i=tn(),r=i.url,o=i.buffer,!r||!sn()){e.next=20;break}s=c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=dn(),on(r,t,(function(){nn(t.data)}));case 2:case"end":return e.stop()}}),e)}));case 16:if(!(rn()>=o)){e.next=20;break}return e.delegateYield(s(),"t10",18);case 18:e.next=16;break;case 20:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();document.addEventListener("visibilitychange",(function(){var e=tn().url;if("hidden"===document.visibilityState&&e&&sn())for(;rn();){var t=dn();fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},credentials:tn().credentials?"include":"same-origin",keepalive:!0,body:JSON.stringify(t)})}}));var fn=function(){var e=l(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hn(t,"business");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pn=function(){var e=l(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hn(t,"technical");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),gn=function(){var e=l(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hn(t,"sensitive");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();window.clickstream||(window.clickstream={setSessionCookie:function(){Ft=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";var e=Wt();try{var t=window.sessionStorage.getItem(e);if(t)Nt(e,t,1);else{var n="".concat(Ht(),".").concat(String(Dt()));Nt(e,n,1),window.sessionStorage.setItem(e,n)}}catch(t){At=t}},getSessionCookie:zt,getSessionCookieError:function(){return At},getDeviceCookie:jt,getDeviceCookieError:function(){return Ot},setConfig:Xt,setMeta:Jt,setProfile:$t,sendEvent:fn,sendSensitiveEvent:gn,sendTechEvent:pn});var vn=function(e){var t=e.logUid,n=e.clientId;window?(Xt({url:"https://ext.clickstream.sberbank.ru/metrics/inner-partners/sber-id",buffer:1,credentials:!1}),Jt({apiKey:"5b63c7457b46f2e2c0c81062da0efbd628c62940db7590f9e97aecac87a43f05",applicationName:n}),$t({clientBlock:n,hashUserLoginId:t})):ft(["Невозможно инициализировать SberVisor"],"error")},bn=function(e){("undefined"==typeof window?"undefined":m(window))>"u"||function(e){var t=e.eventCategory,n=e.eventAction,i=e.eventType,r=e.result,o=e.description,s=e.extendedProperties,a=e.value,c=lt(),u=window.location,l=u.hostname,d=u.origin,h=l;h=h.toUpperCase();try{var f=[{key:"merchUrl",value:d},{key:"partner_name",value:h},{key:"sdkVersion",value:"js_3.6.0"},{key:"channel",value:"browser"},{key:"eventType",value:i}];r&&f.push({key:"result",value:r}),o&&f.push({key:"errorDescription",value:o}),s&&Object.entries(s).forEach((function(e){return f.push({key:e[0],value:e[1]})})),["utm_source","utm_medium","utm_campaign","utm_term","utm_content"].forEach((function(e){c[e]&&f.push({key:e,value:c[e]})})),fn({eventCategory:t,eventAction:n,value:a||"",properties:f}).then((function(){ft(["Успешная отправка события (".concat(t,", ").concat(n,", ").concat(i,") в SberVisor")],"info")})).catch((function(e){ft(["Ошибка при отправке события (".concat(t,", ").concat(n,", ").concat(i,") в SberVisor"),e],"error")}))}catch(f){ft(["Ошибка при отправке события (".concat(t,", ").concat(n,", ").concat(i,") в SberVisor"),f],"error")}}(e)},mn={default:{anonymous:"Войти по Сбер ID",personal:"Войти как {{userName}}"},resume:{anonymous:"Продолжить со Сбер ID",personal:"Продолжить как {{userName}}"},login:{anonymous:"Сбер ID",personal:"Войти как {{userName}}"},fill:{anonymous:"Заполнить со Сбер ID",personal:"Войти как {{userName}}"},custom:{anonymous:"Войти по Сбер ID",personal:"Войти как {{userName}}"},register:{anonymous:"Зарегистрироваться по Сбер ID",personal:"Войти как {{userName}}"},start:{anonymous:"Начать со Сбер ID",personal:"Войти как {{userName}}"},banner:{anonymous:"Войти по Сбер ID",personal:"Продолжить"}},wn={type:"default",loader:!0,logo:!0,custom:mn.custom},yn=function(){function e(t){var n,i,r,o,s;p(this,e),y(this,"link"),y(this,"error"),y(this,"config"),y(this,"userHelper"),y(this,"user"),y(this,"container"),y(this,"changeUserElement"),y(this,"changeUserPopupElement"),y(this,"text"),y(this,"setIsButtonPersonalized"),y(this,"certificateBanner"),y(this,"getHasCertificate"),this.config={personalization:!!t.personalization,debug:!!t.debug,changeUser:!!t.changeUser,type:(null==(r=t.buttonProps)?void 0:r.type)||"default",loader:null===(n=null==(o=t.buttonProps)?void 0:o.loader)||void 0===n||n,logo:null===(i=null==(s=t.buttonProps)?void 0:s.logo)||void 0===i||i,onButtonClick:t.onButtonClick,mintsifry:t.mintsifry},this.container=t.container,this.setIsButtonPersonalized=t.setIsButtonPersonalized,this.text=h(h({},mn[this.config.type]),"custom"===this.config.type?mn.default:{}),this.getHasCertificate=t.getHasCertificate,this.userHelper=Ut.getInstance(),this.userHelper.setListener(this.handleUserChange.bind(this)),this.link=this.create(),this.certificateBanner=new Ae,t.onButtonClick&&this.link.addEventListener("click",this.onButtonClick.bind(this)),this.container.appendChild(this.link),this.config.changeUser&&(this.initChangeUser(),this.error=document.createElement("div"),this.error.innerHTML="".concat(this.config.changeUser?'<span class="sbid-button-change-user__error"></span>':""),this.container.appendChild(this.error))}var t;return v(e,[{key:"onButtonClick",value:function(e){var t,n,i,r,o;return"disabled"===(null==(t=this.link)?void 0:t.getAttribute("disabled"))||"true"===(null==(n=this.link)?void 0:n.getAttribute("disabled"))||"loading"===(null==(i=this.link)?void 0:i.getAttribute("loading"))?(e.preventDefault(),e.stopPropagation(),!1):(!this.getHasCertificate||this.getHasCertificate()||this.certificateBanner.closed?this.config.onButtonClick(e,this.link):this.getHasCertificate()||null!=(r=this.config.mintsifry)&&r.showBanner||null==(o=this.config.mintsifry)||!o.landing?(e.stopPropagation(),e.preventDefault(),this.certificateBanner.show()):(this.setUrl(this.config.mintsifry.landing),this.config.onButtonClick(e,this.link)),!0)}},{key:"initChangeUser",value:function(){var e=this;this.changeUserElement=this.link&&this.link.querySelector(".sbid-button-change-user")||void 0,this.changeUserElement&&(this.changeUserPopupElement=this.changeUserElement.querySelector(".sbid-button-change-user__popup")||void 0,this.changeUserElement.addEventListener("click",(function(t){if(e.changeUserElement){var n="none"===e.changeUserElement.dataset.stage;e.changeUserElement.dataset.stage=n?"popup":"none",n&&e.changeUserPopupElement&&pt(e.changeUserPopupElement,(function(){e.changeUserElement&&(e.changeUserElement.dataset.stage="none")}))}t.preventDefault(),t.stopPropagation()})),this.changeUserPopupElement&&this.changeUserPopupElement.addEventListener("click",this.changeUser.bind(this)))}},{key:"changeUser",value:(t=l(c().mark((function e(t){var n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return vt(),bn({eventCategory:"Login",eventAction:"sberid_Change_User_Button_Click",eventType:"Click"}),this.config.debug&&ft(["Сбрасываем информацию о пользователе"],"info"),e.next=5,this.userHelper.resetUser();case 5:if(!e.sent){e.next=9;break}this.config.debug&&ft(["Данные о пользователе удалены"],"success"),bn({eventCategory:"Login",eventAction:"sberid_Change_User_Result",eventType:"Result",description:"success"}),this.changeUserElement&&(this.changeUserElement.dataset.stage="none"),e.next=10;break;case 9:this.config.debug&&ft(["Ошибка при удалении данных о пользователе"],"error"),bn({eventCategory:"Login",eventAction:"sberid_Change_User_Result",eventType:"Result",description:"fail"}),this.changeUserElement&&(this.changeUserElement.dataset.stage,(n=this.container.querySelector(".sbid-button-change-user__error")||void 0)&&(n.innerHTML="Не удалось сменить пользователя",pt(this.container,(function(){i.changeUserElement&&(i.changeUserElement.dataset.stage="none",n.innerHTML="")}))));case 10:bt(),t.preventDefault(),t.stopPropagation();case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"handleUserChange",value:function(e){this.user=e,this.setText()}},{key:"getSize",value:function(){var e=document.createElement("div"),t=this.create(),n=document.createElement("div");n.innerHTML="".concat(this.config.changeUser?'<span class="sbid-button-change-user__error"></span>':""),e.className="sbid-check-button-container",e.id="i-sbid-check-button-container",e.appendChild(t),e.appendChild(n);var i=t.getBoundingClientRect();return e.remove(),i}},{key:"isEnoughSpaceFromPersonalization",value:function(){var e,t=this.getSize(),n=this.config.changeUser?24:0;return!(t.width+n>=(null==(e=this.container.getBoundingClientRect())?void 0:e.width))||(bn({eventCategory:"Login",eventAction:"sberid_Wrong_Button_Size",eventType:"Show"}),!1)}},{key:"create",value:function(){var e=document.createElement("a");return e.className="sbid-button",e.id="i-sbid-button-".concat(kt(6)),e.dataset.personalization="false",e.innerHTML="\n        ".concat(this.config.logo?'<span class="sbid-button__logo"><svg style="display: block" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13 0C16.0927 0 18.9337 1.08103 21.1657 2.88421L18.6371 4.74793C17.0315 3.64848 15.0899 3.00354 13 3.00354C7.48924 3.00354 3.00587 7.48999 3.00587 13.0013C3.00587 18.5126 7.48924 22.9965 13 22.9965C18.5134 22.9965 22.9968 18.5126 22.9968 13.0013C22.9968 12.9118 22.9941 12.8223 22.9924 12.7328L25.7912 10.6699C25.9289 11.4245 26 12.2055 26 13.0013C26 20.1807 20.1795 26 13 26C5.82135 26 0 20.1807 0 13.0013C0 5.81931 5.82135 0 13 0ZM23.2856 5.05241C23.9006 5.84651 24.4262 6.71169 24.8456 7.63565L13.0002 16.3673L8.05093 13.2628V9.52921L13.0002 12.6337L23.2856 5.05241Z" fill=":logoFill:"/></svg></span>':"",'\n            <span class="sbid-button__text">').concat(this.getText().text,"</span>\n            ").concat(this.config.changeUser?'<span class="sbid-button-change-user" data-stage="none"><svg width="4" height="18" viewBox="0 0 4 18" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="2" cy="2" r="2" fill="white"/><circle cx="2" cy="9" r="2" fill="white"/><circle cx="2" cy="16" r="2" fill="white"/></svg><span class="sbid-button-change-user__popup">Сменить пользователя</span></span></span>':"","\n            ").concat(this.config.loader?'<span class="sbid-button-loader"><span class="sbid-button-loader-icon"></span></span>':"","\n        "),e}},{key:"getText",value:function(){if(this.config.personalization&&this.user){var e=[];return this.user.firstname&&e.push(this.user.firstname),this.user.surname&&e.push(this.user.surname),{text:this.text.personal.replace("{{userName}}",e.join(" ")),personalization:!0}}return{text:this.text.anonymous,personalization:!1}}},{key:"setText",value:function(){if(this.isEnoughSpaceFromPersonalization()&&this.link){var e=this.link.querySelector(".sbid-button__text"),t=this.getText();e&&(e.innerHTML=t.text);var n=t.personalization;this.link.dataset.personalization=n.toString(),this.setIsButtonPersonalized&&n&&this.setIsButtonPersonalized(n),bn({eventCategory:"Login",eventAction:"sberid_Login_Show_Personalization",eventType:"Show",extendedProperties:{personalization:n}})}}},{key:"disable",value:function(){var e;null==(e=this.link)||e.setAttribute("disabled","disabled")}},{key:"enable",value:function(){var e;null==(e=this.link)||e.removeAttribute("disabled")}},{key:"iconShow",value:function(e){var t,n=null==(t=this.link)?void 0:t.querySelector(".sbid-button__logo");n&&(e?n.classList.remove("sbid-button-icon-hide"):n.classList.add("sbid-button-icon-hide"))}},{key:"isDisabled",value:function(){var e;return null==(e=this.link)?void 0:e.hasAttribute("disabled")}},{key:"setUrl",value:function(e){var t;ft(["setUrl",e],"info"),null==(t=this.link)||t.setAttribute("href",e)}},{key:"getButtonElement",value:function(){return this.link}},{key:"getErrorElement",value:function(){return this.error}}]),e}(),kn=function(e){!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&t(e,n)}(r,yn);var i=n(r);function r(e){p(this,r);var t=h(h({},e),{},{buttonProps:{type:"banner"}});return i.call(this,t)}return v(r,[{key:"isEnoughSpaceFromPersonalization",value:function(){return!0}}]),r}(),Cn=function(){function e(){p(this,e)}return v(e,null,[{key:"get",value:function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}},{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.expires;if("number"==typeof i&&i){var r=new Date;r.setTime(r.getTime()+1e3*i),i=n.expires=r}i instanceof Date&&(n.expires=i.toUTCString()),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent);var o="".concat(e,"=").concat(t);for(var s in n)n[s]&&(o+="; ".concat(s),!0!==n[s]&&(o+="=".concat(n[s].split(";")[0])));document.cookie=o}},{key:"delete",value:function(e){this.set(e,"",{expires:-1})}}]),e}(),Ln=function(e){return Ve[e]},_n=function(){function e(t){p(this,e),y(this,"config"),y(this,"proxyParams",["authApp","app_redirect_uri"]),y(this,"parser",ue.getParser(window.navigator.userAgent)),y(this,"logUid"),this.logUid=t.logUid||Lt();var n=this.parser.getBrowserName(),i=t.display&&n!==C.INTERNET_EXPLORER?t.display:"page";this.config={baseUrl:t.baseUrl||Be(t.baseUrl),universalLinkUrl:t.universalLinkUrl||"",deeplinkUrl:t.deeplinkUrl||qe.deeplinkUrl,needAdditionalRedirect:t.needAdditionalRedirect||qe.needAdditionalRedirect,debug:!!t.debug,generateState:!!t.generateState,display:i,params:t.oidcParams},t.utmProxyDisabled||(this.proxyParams=this.proxyParams.concat(["utm_source","utm_medium","utm_campaign","utm_term","utm_content"])),this.config.debug&&(ft(["Инициализируем модуль UniversalLink"],"info"),ft(["Параметры инициализации: ",this.config],"info"))}var t;return v(e,[{key:"isAllowedBrowser",value:function(e){return Ge.includes(e)}},{key:"getAdditionalRedirectParams",value:function(e,t,n){var i={};if(this.config.needAdditionalRedirect&&Object.prototype.hasOwnProperty.call(Ye,e)&&Object.prototype.hasOwnProperty.call(Ye[e],t))switch(e){case Ke.ANDROID:i.package=Ye[e][t];break;case Ke.IOS:var r="";try{r=decodeURIComponent(n||"")}catch(e){ft(["Ошибка декодирования redirect_uri",e],"error")}var o=r.includes("".concat(Ze.HTTPS,"://"))?Ze.HTTPS:Ze.HTTP;i.ext_redirect_uri="".concat(Ye[e][t][o]).concat(r.replace(/^https?:\/\//,""))}return i}},{key:"generateState",value:function(){return kt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:43)}},{key:"buildOidcParams",value:function(e){var t={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n))try{t[n]=decodeURIComponent(e[n])}catch(e){t[n]="",this.config.debug&&ft(["Ошибка декодирования oidc параметра",e],"error")}e.scope&&e.scope.includes("+")&&(e.scope=e.scope.split("+").join(" "));var i=Ln(this.parser.getBrowserName()),r=this.parser.getOSName(!0),o=h({},this.getAdditionalRedirectParams(r,i,t.redirect_uri));o.display=this.config.display||"page";for(var s,a=lt(),c=Object.keys(a),u=0;u<c.length;u+=1)this.proxyParams.includes(c[u])&&(o[c[u]]=a[c[u]]);if(this.config.generateState&&"popup"===this.config.display&&(!(s=lt()).code&&!s.error||!s.state)){var l=this.generateState();Cn.set("sbid_state",l,{path:"/"}),o.state=l}return h(h({},t),o)}},{key:"run",value:(t=l(c().mark((function e(){var t,n,i,r,o,s,a,u,l,d,f,p,g=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g.length>0&&void 0!==g[0]?g[0]:{},e.next=3,this.detect();case 3:return e.t0=e.sent,n="incognito"===e.t0,i=this.parser.getResult(),r=Ln(this.parser.getBrowserName()),o=this.parser.getOSName(!0),s=this.buildOidcParams(h(h(h({},this.config.params),t),{},{logUid:this.logUid})),a=o===Ke.ANDROID&&this.isAllowedBrowser(r),u=o===Ke.IOS&&(r===Ve[C.SAFARI]||this.isAllowedBrowser(r)&&this.config.needAdditionalRedirect),l=!n&&!i.app.name&&(u||a),d=dt(this.config.deeplinkUrl,s),this.config.debug&&(ft(["this.config.universalLinkUrl",this.config.universalLinkUrl],"info"),ft(["this.config.baseUrl",this.config.baseUrl],"info")),f=dt(l?this.config.universalLinkUrl:this.config.baseUrl,s),p={isPrivate:n,isUniversalLink:l,app:i.app.name,isWebview:!!i.app.name,os:o,browser:r,link:f,deeplink:d,oidc:s},e.abrupt("return",(this.config.debug&&ft(["Получены данные для формирования ссылки: ",p]),Promise.resolve(p)));case 16:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"detect",value:function(){try{return(new le).run()}catch(e){return Promise.resolve("normal")}}}]),e}(),Sn=function(){function e(t){p(this,e),y(this,"isFastLoginIframeRegistered",!1),y(this,"isFastLoginDataFetched",!1),y(this,"fastLoginIframe"),y(this,"config"),y(this,"iFrameName"),y(this,"logUid"),this.iFrameName="sberid-iframe",this.isFastLoginIframeRegistered=!1,this.isFastLoginDataFetched=!1,this.logUid=t.logUid||Lt(),this.config=h(h({},Qe),t)}var t,n,i,r;return v(e,[{key:"removeLoadDataListener",value:function(){}},{key:"authorization",value:(r=l(c().mark((function e(t,n){var i,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t||this.config.oidcParams){e.next=3;break}return e.abrupt("return",new Promise((function(e,t){t({code:"error",error:"invalid_request",description:Xe.invalid_request})})));case 3:return r=this.buildUrl(h(h({},i),{},{machineClick:n||k.FAST_LOGIN})),e.next=6,this.createIFrame(r).catch((function(e){return e}));case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"buildUrl",value:function(e){var t=h(h({prompt:"none"},e),{},{logUid:this.logUid});return dt("".concat(this.config.baseUrl).concat(this.config.pathUrl),t)}},{key:"createIFrame",value:(i=l(c().mark((function e(t){var n=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.fastLoginIframe=Et(t,this.iFrameName,(function(e){n.onFastLoginIframeCreateSuccess(e)}),(function(){throw n.destroyFastLogin(),{success:!1,error:{code:"error",error:"iframe_error",description:"Ошибка при создании iframe"}}})),document.body.append(this.fastLoginIframe),this.config.debug&&ft(["Создан iframe вида",this.fastLoginIframe.outerHTML],"success"),new Promise((function(e,t){var i=setTimeout((function(){n.destroyFastLogin(),t({success:!1,error:{type:"timeout",description:"Ошибка при создании iframe"}})}),n.config.timeout),r=_t((function(o){"iframe is registered"===o.type&&(clearTimeout(i),n.isFastLoginIframeRegistered=!0,n.loadFastLoginData().then((function(t){e(t)})).catch((function(e){t(e)})).finally((function(){n.destroyFastLogin()})),r())}))}))));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"onFastLoginIframeCreateSuccess",value:function(e){this.config.debug&&ft(["Iframe для быстрого входа создан",e])}},{key:"loadFastLoginData",value:(n=l(c().mark((function e(){var t=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.isFastLoginIframeRegistered,!e.t0){e.next=4;break}return e.next=4,this.fetchFastLoginData();case 4:return e.abrupt("return",new Promise((function(e,n){t.removeLoadDataListener=_t(function(){var i=l(c().mark((function i(r){return c().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:i.t0=r.type,i.next="iframe is registered"===i.t0?3:"success"===i.t0?6:"error"===i.t0?8:10;break;case 3:return i.next=5,t.fetchFastLoginData();case 5:return i.abrupt("break",10);case 6:return t.config.debug&&ft(["Успешно получены данные при быстром входе",r.data],"success"),e(r.data),i.abrupt("break",10);case 8:return t.config.debug&&ft(["Ошибка получения данных при быстром входе",r.data],"error"),n(r.data),i.abrupt("break",10);case 10:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}())})));case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"fetchFastLoginData",value:(t=l(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.isFastLoginDataFetched||!this.fastLoginIframe||(St({type:"fetch data"},null==(t=this.fastLoginIframe)?void 0:t.contentWindow),this.isFastLoginDataFetched=!0);case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"destroyFastLogin",value:function(){this.config.debug&&ft(["Iframe для быстрого входа удален"]),this.fastLoginIframe&&this.fastLoginIframe.remove(),this.removeLoadDataListener&&this.removeLoadDataListener(),this.isFastLoginIframeRegistered=!1,this.isFastLoginDataFetched=!1}},{key:"getLogUid",value:function(){return this.logUid}}]),e}(),En=function(){function e(){p(this,e),y(this,"userHelper",Ut.getInstance()),y(this,"button",null),y(this,"onButtonClick"),this.create()}return v(e,[{key:"create",value:function(){var e=this;this.button=document.createElement("button"),this.button.textContent="Это не я",this.button.className="sbid-button-not-me",this.button.onclick=function(){var t;null==(t=e.onButtonClick)||t.call(e),e.onClick()}}},{key:"onClick",value:function(){var e=this;this.userHelper.resetUser().then((function(t){t||e.showErrorResetUser()}))}},{key:"showErrorResetUser",value:function(){var e,t,n=document.createElement("div");n.className="sbid-button-not-me_error",n.innerHTML='<div class="sbid-button-not-me_error-wrap">\n        <div class="sbid-button-not-me_error-content">\n          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24.000000" height="24.000000" viewBox="0 0 24 24" fill="none">\n            <defs>\n            <clipPath id="clip204_5640">\n            <rect width="24.000000" height="24.000000" fill="white"/>\n            </clipPath>\n            </defs>\n            <g clip-path="url(#clip204_5640)">\n            <path d="M22.0001 12C22.0001 6.47705 17.5221 2 12.0001 2C6.47815 2 2.00012 6.47705 2.00012 12C2.00012 17.5229 6.47815 22 12.0001 22C17.5221 22 22.0001 17.5229 22.0001 12ZM8.00006 17.0005C7.74408 17.0005 7.48804 16.9026 7.29309 16.7075C6.90204 16.3164 6.90204 15.6846 7.29309 15.2935L10.5859 12.0002L7.29309 8.70752C6.90204 8.31641 6.90204 7.68359 7.29309 7.29248C7.68408 6.90259 8.31604 6.90259 8.70703 7.29248L12.0001 10.5859L15.2931 7.29248C15.6841 6.90259 16.316 6.90259 16.707 7.29248C17.0981 7.68359 17.0981 8.31641 16.707 8.70752L13.4142 12.0002L16.707 15.2935C17.0981 15.6846 17.0981 16.3164 16.707 16.7075C16.5121 16.9026 16.256 17.0005 16.0001 17.0005C15.7441 17.0005 15.488 16.9026 15.2931 16.7075L12.0001 13.4146L8.70703 16.7075C8.51208 16.9026 8.25604 17.0005 8.00006 17.0005Z" clip-rule="evenodd" fill-rule="evenodd" fill="#FA6D20" fill-opacity="1.000000"/>\n            </g>\n          </svg>\n          <div class="sbid-button-not-me_error-text">Не получилось забыть это имя</div>\n        </div>\n        <button class="sbid-button-not-me_error-button">Понятно</button>\n        </div>',null==(t=null==(e=this.button)?void 0:e.parentElement)||t.append(n);var i=document.querySelector(".sbid-button-not-me_error-button");null==i||i.addEventListener("click",(function(e){n.remove()}))}}]),e}(),xn=function(e){var t=e.bannerText,n=e.bannerTheme,i=e.sourceType;bn({eventCategory:"Login",eventAction:"oidc-cloud_Auth_Banner screen",eventType:"Click",value:"pers_banner"===i?"Продолжить":"Войти по Сбер ID",extendedProperties:{banner_text:t,banner_theme:n,source_type:i}})},An=function(e){return e.topRight="top-right",e.bottomRight="bottom-right",e.topLeft="top-left",e.bottomLeft="bottom-left",e}(An||{}),On=function(e){return e.white="white",e.dark="dark",e}(On||{}),Un=function(e){return e.default="default",e.loyalty="loyalty",e}(Un||{}),In={autoCloseDelay:90,autoClose:!1,enable:!0,position:An.bottomRight,debug:!1,fastLogin:!1,theme:On.white,serviceName:"сервис",textType:Un.default,textOfferExtension:""},Tn={default:{main:{title:"Привет! Войдём без пароля?",description:"Сервис не получит доступ к вашему СберБанк Онлайн, вкладам, счетам и балансу карт. Всё защищено технологиями Сбера"},user:{title:"Привет, {{userName}}!\n Войдем в {{service}}?",description:"Сервис не получит доступ к вашему СберБанк Онлайн, автосписаний не будет. Всё защищено технологиями Сбера"}},loyalty:{main:{title:"Привет! Войдём без пароля?",description:"После входа вы сможете копить и тратить до 99% бонусов СберСпасибо"},user:{title:"Привет, {{userName}}!\n Войдем в {{service}}?",description:"После входа вы сможете копить и тратить до 99% бонусов СберСпасибо"}}},Pn=function(){function e(t){var n,i=this;p(this,e),y(this,"config"),y(this,"button"),y(this,"notification"),y(this,"parser",ue.getParser(window.navigator.userAgent)),y(this,"userHelper"),y(this,"universalLinkDetect"),y(this,"fastLogin"),y(this,"user"),y(this,"notMeButton"),y(this,"oidcParams"),y(this,"theme",On.white),y(this,"themeAttributeName","data-theme"),y(this,"positionAttributeName","data-position"),y(this,"maxServiceName",15),y(this,"onSuccessCallback",(function(){})),y(this,"onErrorCallback",(function(){})),y(this,"isShow",!1),y(this,"notificationText",Tn.default),y(this,"OIDCProps"),y(this,"getOfferText",(function(e){var t="Продолжая использовать Сбер ID,\n я принимаю [условия оферты](https://cms-res-web.online.sberbank.ru/sberid/Oferta/actual/oferta.pdf)"+e;return{isOfferTextLengthBiggerThenMax:t.replace(/[\[\]]|\([^)]+\)/gm,"").length>140,offerFormatText:e?t.replace("\n",""):t}})),this.notification=document.createElement("div"),this.config=h(h(h({},In),t.notification),{},{serviceName:t.notification.serviceName&&t.notification.serviceName.length<=this.maxServiceName?t.notification.serviceName:In.serviceName,fastLogin:!(null==(n=t.fastLogin)||!n.enable),debug:!!t.debug}),this.theme=t.notification.theme?t.notification.theme:this.theme,this.notificationText=Tn[this.config.textType],this.config.debug&&(ft(["Конфиг переданный NotificationBanner",t],"info"),ft(["Формирование конфига NotificationBanner",this.config],"info")),this.userHelper=Ut.getInstance(),this.userHelper.setConfig(t.userHelper),this.userHelper.setListener(this.setUser.bind(this)),this.universalLinkDetect=new _n(t.universalLink),this.fastLogin=new Sn(t.fastLogin),this.notMeButton=new En,this.notMeButton.onButtonClick=function(){!function(e){var t=e.bannerText,n=e.bannerTheme,i=e.sourceType;bn({eventCategory:"Login",eventAction:"oidc-cloud_Auth_Banner screen",eventType:"Click",value:"Это не Я",extendedProperties:{banner_text:t,banner_theme:n,source_type:i}})}(i.getAnalyticsProps())},t.onSuccessCallback&&(this.onSuccessCallback=t.onSuccessCallback),t.onErrorCallback&&(this.onErrorCallback=t.onErrorCallback),this.button=new kn(h(h({},t),{},{container:this.notification,onButtonClick:this.handleButtonClick.bind(this)})),this.OIDCProps={oidc:t.oidc,baseUrl:t.baseUrl,mweb2app:t.mweb2app},this.setOIDCParams(this.OIDCProps),this.config.enable&&this.create()}var t,n,i,r;return v(e,[{key:"setUser",value:(r=l(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.user=t,e.next=3,this.setOIDCParams(this.OIDCProps);case 3:this.render();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"setOIDCParams",value:(i=l(c().mark((function e(t){var n,i,r,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.universalLinkDetect.buildOidcParams(h(h({},t.oidc),{},{source_type:this.user?"pers_banner":"banner"})),i=Object.keys(n),r=i.includes("app_redirect_uri")||i.includes("authApp")||"false"===i.is_universal_link,!t.mweb2app||r){e.next=8;break}return e.next=4,this.universalLinkDetect.run(n);case 4:o=e.sent,this.button.setUrl(o.link),e.next=9;break;case 8:this.button.setUrl(dt(t.baseUrl,n));case 9:this.oidcParams=h({},n);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"silentAuthorization",value:(n=l(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fastLogin.authorization(this.oidcParams,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"render",value:function(){var e,t,n,i,r=this;if(this.button.link){var s=this.user?this.notificationText.user.title.replace("{{userName}}",this.user.firstname||"").replace("{{service}}",this.config.serviceName):this.notificationText.main.title,a=this.user?this.notificationText.user.description:this.notificationText.main.description,c='<div class="sbid-certificate-banner_avatar">'.concat("".concat(null==(t=null==(e=this.user)?void 0:e.firstname)?void 0:t[0]).concat(null==(i=null==(n=this.user)?void 0:n.surname)?void 0:i[0]).toUpperCase(),"</div>");this.notification.innerHTML='<div class="sbid-notification-banner__heading"> <svg width="94" height="20" viewBox="0 0 94 20" fill="none" xmlns="http://www.w3.org/2000/svg"> <path fill-rule="evenodd" clip-rule="evenodd" d="'.concat("M9.83569 2.30947C9.95959 2.30966 10.0827 2.31431 10.2052 2.32046L10.2053 2.31873C11.5937 2.38831 12.9388 2.84844 14.0891 3.65149L15.9969 2.21838C14.2526 0.781145 12.0756 -0.00204584 9.83121 4.01362e-06L9.82778 3.40423e-06C8.53758 -0.00108123 7.25986 0.25703 6.06792 0.759529C5.02652 1.19856 4.06851 1.8166 3.2353 2.58545L3.23447 2.58452C2.21478 3.52091 1.3999 4.66493 0.842694 5.94237C0.351686 7.06804 0.0704162 8.27517 0.0116234 9.50242L0.0115805 9.50242L0.00975407 9.54315C0.00318651 9.69282 -6.62805e-05 9.84279 6.96975e-06 9.99293L3.3457e-06 10.0018C-0.00106264 11.3146 0.25261 12.6147 0.74647 13.8275C1.18996 14.9166 1.81931 15.916 2.60442 16.7801C3.51252 17.784 4.61365 18.5878 5.83988 19.1415C6.94564 19.6409 8.13137 19.927 9.33689 19.9871L9.33687 19.9874C9.49894 19.9958 9.66255 20 9.82771 20C11.118 20.0014 12.3959 19.7433 13.5879 19.2407C14.6293 18.8015 15.5873 18.1832 16.4203 17.4139L16.4206 17.4143C17.4403 16.4779 18.2552 15.3339 18.8124 14.0564C19.3696 12.779 19.6567 11.3967 19.6551 9.99905C19.6563 9.39823 19.6047 8.79851 19.5007 8.20708L17.3853 9.79331V9.99905C17.3857 11.0736 17.1643 12.1362 16.7352 13.118C16.357 13.9835 15.825 14.7693 15.1669 15.4362L15.166 15.4353C15.0887 15.5142 15.0099 15.5913 14.9294 15.6666L14.8948 15.6985L14.895 15.6986C14.2548 16.2904 13.5184 16.7663 12.7179 17.1045C11.8018 17.4916 10.8196 17.6907 9.82771 17.6905H9.82752V17.6895C8.77155 17.69 7.72726 17.4647 6.76231 17.0283C5.91229 16.6439 5.14054 16.1032 4.48534 15.4345L4.48626 15.4335C4.39948 15.3456 4.3149 15.2556 4.23261 15.1636L4.22606 15.1562L4.22604 15.1563C3.64465 14.505 3.1772 13.756 2.84502 12.9416C2.46467 12.0091 2.26917 11.0094 2.26976 9.99976C2.26971 9.88081 2.27238 9.76201 2.27775 9.64344L2.27979 9.6155L2.27906 9.61546C2.32513 8.67269 2.5419 7.74551 2.91958 6.88093C3.29774 6.01525 3.82978 5.22936 4.48786 4.5623L4.49026 4.56474C5.19015 3.84972 6.02196 3.28241 6.93793 2.89539C7.85237 2.50901 8.8327 2.30991 9.82282 2.30946V2.30947L9.83569 2.30947ZM18.7824 5.87408C18.4668 5.16717 18.0716 4.49994 17.6047 3.88579L9.82997 9.71794L6.08846 7.33152V10.2024L9.82997 12.5889L18.7824 5.87408ZM77.8962 16.0249H80.0018V4.02681H77.8962V16.0249ZM89.8319 13.0082C89.1244 13.7053 88.0349 14.0538 86.5639 14.0538H84.6603V5.99785H86.5807C88.0742 5.99785 89.1665 6.32941 89.8572 6.992C90.5478 7.65486 90.8931 8.65459 90.8931 9.99154C90.8931 11.3057 90.5394 12.3114 89.8319 13.0082ZM91.4997 5.51799C90.4325 4.52384 88.8043 4.02681 86.6145 4.02681H82.5546V16.0248H86.5639C87.5183 16.0248 88.3972 15.9048 89.2002 15.6649C90.003 15.425 90.6936 15.0538 91.2722 14.5508C91.8505 14.0482 92.2997 13.4024 92.6199 12.6139C92.9399 11.8255 93.0999 10.8828 93.0999 9.78588C93.0999 7.93471 92.5664 6.51206 91.4997 5.51799ZM57.0908 6.02342L59.7556 4.02518H50.8373V16.0267H59.7556V14.0284H53.3823V10.9559H58.8185V8.95758H53.3823V6.02342H57.0908ZM41.0078 14.0284H43.6618C45.233 14.0284 46.0296 13.4959 46.0296 12.3651C46.0296 11.2582 45.2772 10.7017 43.6618 10.7017H41.0078V14.0284ZM41.0078 8.70344H44.1049C46.9178 8.70344 48.4669 9.96533 48.4669 12.2566C48.4669 14.6526 46.7574 16.0267 43.7768 16.0267H38.4627V4.02518H48.6167L45.9519 6.02342H41.0078V8.70344ZM66.9264 10.6287H64.6704V6.02325H66.9264C68.5572 6.02325 69.4552 6.84103 69.4552 8.32594C69.4552 9.81093 68.5572 10.6287 66.9264 10.6287ZM66.9809 4.02518H62.1254V16.0265H64.6704V12.627H66.9809C70.0794 12.627 72.0043 10.9692 72.0043 8.32009C72.0043 5.67094 70.0794 4.02518 66.9809 4.02518ZM31.8967 13.9882C32.6814 13.9882 33.4412 13.7945 34.0939 13.4281L34.6579 13.1141L36.3049 14.3492C35.2189 15.5334 33.6168 16.1844 31.782 16.1844C30.0283 16.1844 28.4287 15.5543 27.2783 14.41C26.1312 13.2691 25.4994 11.6886 25.4994 9.9597C25.4994 8.23853 26.1334 6.68091 27.2846 5.57395C28.429 4.47352 30.032 3.86742 31.7983 3.86742C33.4265 3.86742 34.8506 4.37099 35.9165 5.32373L36.0372 5.4314L34.2117 6.80035C33.5427 6.3116 32.7648 6.06322 31.8967 6.06322C29.6022 6.06322 27.9368 7.72982 27.9368 10.0258C27.9368 12.3218 29.6022 13.9882 31.8967 13.9882Z",'" fill="var(--sbid-banner-logo-color)"/></svg> <div class="sbid-notification-banner__close">  <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">   <path fill-rule="evenodd" clip-rule="evenodd" d="').concat("M6 4.65094L10.3675 0.282877C10.7431 -0.0927631 11.3485 -0.0942703 11.721 0.27826C12.0961 0.653395 12.0914 1.25686 11.7164 1.63195L7.34886 6L11.7164 10.368C12.0914 10.7431 12.0961 11.3466 11.721 11.7217C11.3485 12.0943 10.7431 12.0928 10.3675 11.7171L6 7.34906L1.63247 11.7171C1.25688 12.0928 0.651469 12.0943 0.278986 11.7217C-0.0960822 11.3466 -0.0914182 10.7431 0.283602 10.368L4.65114 6L0.283602 1.63195C-0.0914182 1.25686 -0.0960822 0.653395 0.278986 0.27826C0.651469 -0.0942703 1.25688 -0.0927631 1.63247 0.282877L6 4.65094Z",'" fill="var(--sbid-banner-icon-close-color)"/></svg></div></div><div class="sbid-notification-banner__message_block"><div class="sbid-notification-banner__title_block">').concat(this.user?c:"",'<div class="sbid-notification-banner__title">').concat(s,'</div></div><div class="sbid-notification-banner__description">').concat(a,"</div></div>"),this.notification.getElementsByClassName("sbid-notification-banner__close")[0].addEventListener("click",(function(){return r.onClose.bind(r)()})),this.button.iconShow(!this.user),this.button.link.classList.add("sbid-notification-banner_button");var u=document.createElement("div");u.className="sbid-notification-buttons_block",this.user&&this.notMeButton.button&&u.appendChild(this.notMeButton.button),u.appendChild(this.button.link);var l=this.getOfferText(this.config.textOfferExtension),d=l.offerFormatText,h=l.isOfferTextLengthBiggerThenMax,f=document.createElement("div");h&&f.classList.add("sbid-notification-offer_container"),f.innerHTML='<div class="sbid-notification-offer">'.concat(function(e){var t=e.match(/\[[^\[]+?\)/gm)||[],n=e,i=/\[([^\[]+)\]\((.*)\)/;return t.forEach((function(e){var t=o(i.exec(e)||[],3),r=(t[0],t[1]),s=t[2];n=n.replace("[".concat(r,"](").concat(s,")"),'<a class="sbid-link" target="_blank" href="'.concat(s,'">').concat(r,"</a>"))})),n}(d),"</div>"),h&&this.notification.appendChild(f),this.notification.appendChild(u),h||this.notification.appendChild(f)}else console.error("Ошибка, отсутствует кнопка входа")}},{key:"create",value:function(){if(document.getElementById("i-sbid-notification-banner"))console.error("Баннер СберID уже создан");else{this.config.debug&&ft("Создание баннера"),this.notification||(this.notification=document.createElement("div"));var e=document.getElementsByTagName("body")[0];this.notification.className="sbid-notification-banner",this.notification.id="i-sbid-notification-banner",this.setTheme(this.theme),this.setPosition(this.config.position),this.render(),e.appendChild(this.notification)}}},{key:"handleButtonClick",value:(t=l(c().mark((function e(t){var n,i,r,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),t.stopPropagation(),"true"!==(null==(n=t.target)?void 0:n.getAttribute("disabled"))){e.next=2;break}return e.abrupt("return",!1);case 2:if(xn(this.getAnalyticsProps()),vt(),this.button.disable(),r=(null==(i=t.target.closest(".sbid-button"))?void 0:i.getAttribute("href"))||"",!this.user||!this.config.fastLogin){e.next=11;break}return e.next=7,this.silentAuthorization(k.FAST_LOGIN);case 7:(o=e.sent).success?(this.config.debug&&ft(["Успешный быстрый вход",o.data],"success"),bt(),this.onSuccessCallback(o.data),this.onClose(!1)):(this.config.debug&&ft(["Ошибка быстрого входа",o.data],"error"),bt(),window.location.href=r),bt(),this.button.enable(),e.next=12;break;case 11:bt(),window.location.href=r;case 12:return e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"isMobile",value:function(){return"mobile"===this.parser.getPlatformType(!0)}},{key:"isNotification",value:function(){return!!this.notification}},{key:"show",value:function(){var e=this;this.notification.classList.contains("sbid-notification-banner--show")||(this.isShow=!0,this.config.debug&&ft("Показ баннера"),setTimeout((function(){var t,n,i,r;e.notification.classList.add("sbid-notification-banner--show"),t=e.getAnalyticsProps(),n=t.bannerText,i=t.bannerTheme,r=t.sourceType,bn({eventCategory:"Login",eventAction:"oidc-cloud_Auth_Banner screen",eventType:"Show",extendedProperties:{banner_text:n,banner_theme:i,source_type:r}}),e.isMobile()&&e.config.autoClose&&(e.config.debug&&ft("Баннер будет скрыт через ".concat(e.config.autoCloseDelay," секунд.")),setTimeout(e.onClose.bind(e),1e3*e.config.autoCloseDelay)),"function"==typeof e.config.onOpen&&e.config.onOpen()}),200))}},{key:"hide",value:function(){this.config.debug&&ft("Скрытие баннера"),this.isShow=!0,this.notification&&this.notification.classList.remove("sbid-notification-banner--show")}},{key:"onClose",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.notification&&this.hide(),e){!function(e){var t=e.bannerText,n=e.bannerTheme,i=e.sourceType;bn({eventCategory:"Login",eventAction:"oidc-cloud_Auth_Banner screen",eventType:"Click",value:"Закрытие",extendedProperties:{banner_text:t,banner_theme:n,source_type:i}})}(this.getAnalyticsProps());var t=+Cn.get("sbid_notification_banner_close_count")||0,n=new Date;Cn.set("sbid_notification_banner_closed","1",{path:"/",expires:this.getCookieExpires(t)}),Cn.set("sbid_notification_banner_close_count","".concat(t+1),{path:"/",expires:new Date(n.getFullYear()+1,n.getMonth(),n.getDate())})}this.config.onClose&&"function"==typeof this.config.onClose&&this.config.onClose()}},{key:"switchTheme",value:function(){this.getTheme()===On.white?this.setTheme(On.dark):this.setTheme(On.white)}},{key:"setTheme",value:function(e){this.theme=e,this.notification.setAttribute(this.themeAttributeName,this.theme)}},{key:"getTheme",value:function(){return this.theme}},{key:"setPosition",value:function(e){this.notification.setAttribute(this.positionAttributeName,e)}},{key:"getPosition",value:function(){return this.notification.getAttribute(this.themeAttributeName)}},{key:"getCookieExpires",value:function(e){var t=[7200,86400,604800,2419200],n=e||0;return e>=t.length&&(n=t.length-1),t[n]}},{key:"destroy",value:function(){this.config.debug&&ft("Удаление баннера"),this.notification.remove()}},{key:"getAnalyticsProps",value:function(){return{sourceType:this.user?"pers_banner":"banner",bannerText:this.config.textType,bannerTheme:this.getTheme()}}}]),e}(),Rn=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;p(this,e),y(this,"LAST_UPD_KEY","sbid_last_upd"),y(this,"DAY",864e5),y(this,"MAX_COOKIE_LIFE_DAY",31),y(this,"oidc"),y(this,"updateCookiePeriod",6),y(this,"onUpdateCookie"),y(this,"saEnable",!0),this.oidc=t,this.saEnable=n,i&&(this.updateCookiePeriod=Math.min(Math.abs(parseInt("".concat(i)))||this.updateCookiePeriod,this.MAX_COOKIE_LIFE_DAY)),r&&(this.onUpdateCookie=r)}var t;return v(e,[{key:"setDTUpdate",value:(t=l(c().mark((function e(t,n){var i,r,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o in i="".concat(t),this.saEnable&&bn({eventCategory:"Login",eventAction:"sberid_Login_Button_Click",eventType:"Result",extendedProperties:{machineClick:k.COOKIE_AUTOUPDATE}}),r={},this.oidc)if(Object.prototype.hasOwnProperty.call(this.oidc,o))try{r[o]=decodeURIComponent(this.oidc[o])}catch(e){r[o]=""}return e.next=6,n.authorization(r,k.COOKIE_AUTOUPDATE);case 6:if(!e.sent.success){e.next=11;break}try{localStorage.setItem(this.LAST_UPD_KEY,i)}catch(e){}this.onUpdateCookie&&this.onUpdateCookie(),this.saEnable&&bn({eventCategory:"AutoUpdateCookie",eventAction:"sberid_Cookie_Auto_Update_success",eventType:"Click"}),e.next=12;break;case 11:try{localStorage.removeItem(this.LAST_UPD_KEY)}catch(e){}case 12:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"updateCookie",value:function(e){var t=Date.now(),n=null;try{n=localStorage.getItem(this.LAST_UPD_KEY)}catch(e){}n?+n+this.updateCookiePeriod*this.DAY<t&&this.setDTUpdate(t,e):this.setDTUpdate(t,e)}}]),e}(),Bn=function(){function e(t){return p(this,e),y(this,"clientId",""),y(this,"cache",new ze),y(this,"CACHE_ACTUAL_TIMER",864e5),e.instance?e.instance:(this.clientId=t,e.instance=this,this)}var t;return v(e,[{key:"checkHiddenList",value:function(e){return!e.includes(this.clientId)}},{key:"isButtonShow",value:(t=l(c().mark((function t(){var n,i,r,o,s,a,u;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=(new Date).getTime(),r=JSON.parse(localStorage.getItem(e.HIDDEN_LIST_CACHE)),t.next=4,this.cache.get(e.HIDDEN_LIST_CACHE);case 4:if(!(o=t.sent)&&(null==r?void 0:r.timeUpdate)+this.CACHE_ACTUAL_TIMER>i&&(o=r.hiddenList),!o){t.next=7;break}return t.abrupt("return",(null!=(n=null==r?void 0:r.hiddenList)&&n.length||localStorage.setItem(e.HIDDEN_LIST_CACHE,JSON.stringify({timeUpdate:i,hiddenList:o})),this.checkHiddenList(o)));case 7:return t.prev=7,t.next=10,fetch("https://cms-res-web.online.sberbank.ru/sberid/BlackList/Button/No_Button.json",{mode:"no-cors"});case 10:if(!(s=t.sent).ok){t.next=25;break}return t.next=14,s.json();case 14:if(t.t1=a=t.sent,t.t0=null!==t.t1,!t.t0){t.next=18;break}t.t0=void 0!==a;case 18:if(!t.t0){t.next=22;break}t.t2=a,t.next=23;break;case 22:t.t2=[];case 23:return u=t.t2,t.abrupt("return",(this.cache.set(e.HIDDEN_LIST_CACHE,u),localStorage.setItem(e.HIDDEN_LIST_CACHE,JSON.stringify({timeUpdate:i,hiddenList:u})),this.checkHiddenList(u)));case 25:t.next=30;break;case 27:t.prev=27,t.t3=t.catch(7),ft(["Ошибка получения чёрного списка."]);case 30:t.next=34;break;case 32:t.prev=32,t.t4=t.catch(0);case 34:return t.abrupt("return",!0);case 35:case"end":return t.stop()}}),t,this,[[0,32],[7,27]])}))),function(){return t.apply(this,arguments)})}]),e}();y(Bn,"instance"),y(Bn,"HIDDEN_LIST_CACHE","hiddenListCache");var Dn=Bn,Nn=function(){function e(t){p(this,e),y(this,"cache",new ze),y(this,"checkUrl"),y(this,"cacheKey","hasCertificate"),this.checkUrl=t}var t;return v(e,[{key:"timeout",value:function(e,t){return new Promise((function(n,i){setTimeout((function(){i(!1)}),e),t.then(n,i)}))}},{key:"onCheck",value:(t=l(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.checkUrl){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,this.cache.get(this.cacheKey);case 4:if(!e.sent){e.next=6;break}return e.abrupt("return",!0);case 6:return e.prev=6,e.next=9,this.timeout(Ie,fetch(this.checkUrl,{method:"GET",mode:"no-cors"}).then((function(){return{success:!0}})).catch((function(){return{success:!1}})));case 9:return t=e.sent,e.abrupt("return",(t.success&&this.cache.set(this.cacheKey,!0),t.success));case 13:return e.prev=13,e.t0=e.catch(6),e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,this,[[6,13]])}))),function(){return t.apply(this,arguments)})}]),e}(),Mn=function(){function e(t){var n,i,r,o,s,a,c,u,l,d,f=this;p(this,e),y(this,"buttons",[]),y(this,"user"),y(this,"oidcParams"),y(this,"config"),y(this,"parser",ue.getParser(window.navigator.userAgent)),y(this,"windowStatus","closed"),y(this,"w"),y(this,"fastLogin"),y(this,"universalLinkDetect"),y(this,"theme","green"),y(this,"notifyBanner"),y(this,"isButtonPersonalized",!1),y(this,"userHelper",Ut.getInstance()),y(this,"autoUpdateCookie"),y(this,"isExitedFromAutoLogin",!!parseInt(null!==(n=Cn.get("sbid_exited_from_auto_login"))&&void 0!==n?n:"0",10)),y(this,"hasCertificate",!0),y(this,"onButtonClick"),y(this,"debugByUrlParam",new URLSearchParams(window.location.search).has("sberidDebug")),y(this,"logUid",Lt()),y(this,"isBannerClosed",parseInt(null!==(i=Cn.get("sbid_notification_banner_closed"))&&void 0!==i?i:"0",10)),y(this,"onSuccessCallback",(function(){})),y(this,"onErrorCallback",(function(){})),y(this,"setIsButtonPersonalized",(function(e){f.isButtonPersonalized=e,f.setOIDCParams(h(h({},f.config.oidc),{},{personalization:e.toString()}))}));var g=wt(et,h(h({},t),{},{debug:this.debugByUrlParam?this.debugByUrlParam:t.debug,oidc:t.oidc?t.oidc:et.oidc}));null!=(r=g.fastLogin)&&r.enable&&g.autoUpdateCookie&&(console.warn("[SberidSDK] Не верная конфигурация: одновременно может быть включена функция Быстрого входа fastLogin.enable или Автоподогрева куки autoUpdateCookie"),console.warn("Если это конфиг для прелогин зоны, то удалите autoUpdateCookie, если постологин зона то отключите параметры Быстрого входа fastLogin.enable: false")),null!=(o=g.fastLogin)&&o.enable&&!g.personalization&&console.warn("[SberidSDK] Не верная конфигурация: функционал Быстрого входа не доступен, если не включена Персональная кнопка, проверьте что параметр personalization: true "),g.onButtonClick&&console.warn("[SberidSDK] onButtonClick - deprecated. Вы используете устаревший функционал в следующих версиях данная функция будет удалена"),g.onButtonClick&&null!=(s=g.fastLogin)&&s.enable&&console.warn("[SberidSDK] При использовании onButtonClick не доступен функционал Быстрого входа"),null!=(a=g.buttonProps)&&a.custom&&console.warn("[SberidSDK] Параметр buttonProps.custom более не доступно, будет использовано значение ключа default"),null!=(c=g.oidc)&&c.client_id||console.warn("[SberidSDK] Динамическая установка client_id, является не стабильным функционалом в текущей версииВам необходимо самостоятельно контролировать состояние кнопки, что бы пользователь не перешел по не верной ссылке"),null!=(u=g.cloud)&&u.enable&&(g.baseUrl=g.cloud.baseUrl),g.onSuccessCallback&&(this.onSuccessCallback=g.onSuccessCallback),g.onErrorCallback&&(this.onErrorCallback=g.onErrorCallback),g.autoUpdateCookie&&(this.autoUpdateCookie=new Rn(g.oidc,!0,g.updateCookiePeriod,g.onUpdateCookie)),this.createConfig(g),null!=(l=g.mintsifry)&&l.enable&&new Nn(null==(d=this.config.https)?void 0:d.checker).onCheck().then((function(e){f.hasCertificate=e,bn({eventCategory:"Login",eventAction:"certificate_check_is_".concat(e),eventType:"Result"}),f.config.debug&&ft(["Результат проверки наличия сертификатов МинЦифры:",e],"info")})),this.onButtonClick=g.onButtonClick||this.handleButtonClick.bind(this),this.onInit(),new Dn(this.config.oidc.client_id).isButtonShow().then((function(e){e||(f.buttons.map((function(e){var t,n;null==(t=e.getButtonElement())||t.remove(),null==(n=e.getErrorElement())||n.remove()})),bn({eventCategory:"Login",eventAction:"sberid_Login_Blocked",eventType:"Result",extendedProperties:{}}))}))}var t,n,i,r,o,s;return v(e,[{key:"disable",value:function(){for(var e=0;e<this.buttons.length;e+=1)this.buttons[e].disable()}},{key:"enable",value:function(){for(var e=0;e<this.buttons.length;e+=1)this.buttons[e].enable()}},{key:"logout",value:function(t){e.logout(t)}},{key:"getLogUid",value:function(){return this.logUid}},{key:"sendOtherAuth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this.parser.getOSName(!0);!function(e){var t=e.os,n=e.client_id,i=e.authService,r=e.successAuth,o=void 0===r?null:r,s=e.isUserNew,a=void 0===s?null:s,c=Ct(t);bn({eventCategory:"",eventAction:"",eventType:"Other Authorization",extendedProperties:{clientID:n,authService:i,successAuth:o,chanel:c,isUserNew:a}})}({successAuth:t,authService:e,client_id:this.config.oidc.client_id,isUserNew:n,os:i})}},{key:"sendErrorAuth",value:function(e){!function(e){var t=e.errorText,n=e.os,i=e.clientID,r=Ct(n);bn({eventCategory:"Login",eventAction:"Error",eventType:"Partner Error",extendedProperties:{clientID:i,chanel:r,error:t}})}({errorText:e,os:this.parser.getOSName(!0),clientID:this.config.oidc.client_id})}},{key:"setOIDCParams",value:(s=l(c().mark((function e(t){var n,i,r,o,s,a,u,l,d;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.universalLinkDetect.buildOidcParams(h(h({},t),{},{personalization:this.isButtonPersonalized.toString(),logUid:this.logUid},this.config.https.enable&&null!=(n=this.config.cloud)&&n.enable?{isCloud:""}:{})),r=Object.keys(i),o=r.includes("app_redirect_uri")&&r.includes("authApp")||"false"===r.is_universal_link,this.oidcParams=h({},i),s="mobile"===this.parser.getPlatformType(!0),a=this.config.baseUrl,this.config.debug&&ft(["setOIDCParams baseUrl",a],"info"),!(s&&this.config.deeplink.enable&&i.sberIDRedirect)){e.next=14;break}if(u=decodeURIComponent(i.sberIDRedirect),!(this.config.deeplink.allowSberIDRedirects.length>0&&-1!==this.config.deeplink.allowSberIDRedirects.indexOf(u)||0===this.config.deeplink.allowSberIDRedirects.length)){e.next=14;break}if(a=u,o=!0,"auto"!==this.config.deeplink.mode){e.next=13;break}return this.config.debug&&ft(["Автоматический переход по deeplink: ",dt(a,this.oidcParams)]),window.location.href=dt(a,this.oidcParams),e.abrupt("return");case 13:this.config.debug&&ft(["Будет осуществлен переход по deeplink: ",dt(a,this.oidcParams)]);case 14:if(!this.config.mweb2app||o){e.next=21;break}return e.next=17,this.universalLinkDetect.run(this.oidcParams);case 17:l=e.sent,this.config.debug&&ft(["Сформирована ссылка через universalLinkDetect",l]),this.sbUniversalLinkCallback(l),e.next=23;break;case 21:d=dt(a,this.oidcParams),this.config.debug&&ft(["Сформирована ссылка:",d],"info"),this.sbUniversalLinkCallback({isUniversalLink:!1,link:dt(a,this.oidcParams)});case 23:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"removeWindowListener",value:function(){}},{key:"createConfig",value:function(e){var t,n,i,r,o,s=h({},e);delete s.container,bn({eventCategory:"Login",eventAction:"sberid_Login_Show",eventType:"Show",extendedProperties:{SDK_Initialization:s}});var a=h({enable:!1,allowSberIDRedirects:[],mode:"default"},e.deeplink),c=h(h({},tt),e.mintsifry),u=this.parser.getBrowserName(),l=e.display&&u!==C.INTERNET_EXPLORER?e.display:"page",d=c.enable&&c.landing,f=h(h({},$e),e.cloud),p=h(h(h({},Qe),e.fastLogin),{},{baseUrl:f.enable?f.baseUrl:e.baseUrl||Oe,pathUrl:f.enable?f.iframeUrl:Re,logUid:this.logUid}),g=Be(null!==(t=e.baseUrl)&&void 0!==t?t:Oe),v=(null==(i=e.universalLink)?void 0:i.universalLinkUrl)||De(null!==(n=e.baseUrl)&&void 0!==n?n:Oe),b={addProcessId:f.enable,getUserUrl:f.enable?f.getUserUrl:Te,changeUserUrl:f.enable?f.changeUserUrl:Pe,baseUrl:f.enable?f.baseUrl:e.baseUrl||Oe,iframeUrlPath:f.enable?f.iframeUrl:void 0,oidcParams:e.oidc,clientId:e.oidc.client_id,debug:e.debug,logUid:this.logUid};this.config={personalization:!!e.personalization,onPersonalizationStatus:e.onPersonalizationStatus,changeUser:!!e.changeUser,baseUrl:d&&c.landing?c.landing:g,debug:!!e.debug,mweb2app:!!e.mweb2app,fastLogin:p,notification:h(h({},In),e.notification),userHelper:b,display:l,sa:{clientId:e.oidc.client_id,logUid:this.logUid},generateState:!!e.generateState,oidc:e.oidc,container:e.container,deeplink:a,cloud:f,https:c,universalLink:h(h(h({},qe),e.universalLink),{},{universalLinkUrl:d&&c.landing?c.landing:v,oidcParams:(null==(r=e.universalLink)?void 0:r.oidcParams)||e.oidc,baseUrl:d&&c.landing?c.landing:(null==(o=e.universalLink)?void 0:o.baseUrl)||g,logUid:this.logUid}),buttonProps:h(h({},wn),e.buttonProps)};var m={version:"3.6.0",partnerConfig:e,config:this.config};window.sberIdSdkInfo?window.sberIdSdkInfo.push(m):window.sberIdSdkInfo=[m]}},{key:"onInit",value:function(){var e,t=this;if(this.config.debug&&(ft(["Инициализируем SDK"],"info"),ft(["Параметры инициализации: ",this.config],"info")),vn(this.config.sa),this.userHelper.setConfig(h({},this.config.userHelper)),this.userHelper.setListener(this.handleUserChange.bind(this)),this.fastLogin=new Sn(h({},this.config.fastLogin)),this.autoUpdateCookie&&this.autoUpdateCookie.updateCookie(this.fastLogin),this.config.notification.enable&&(this.notifyBanner=new Pn({userHelper:this.config.userHelper,notification:this.config.notification,oidc:this.config.oidc,mintsifry:this.config.https,buttonProps:this.config.buttonProps,baseUrl:this.config.baseUrl,universalLink:this.config.universalLink,fastLogin:this.config.fastLogin,mweb2app:this.config.mweb2app,debug:this.config.debug,onErrorCallback:this.onErrorCallback,onSuccessCallback:this.onSuccessCallback,personalization:this.config.personalization})),this.universalLinkDetect=new _n(this.config.universalLink),this.config.container){var n=[];n=this.config.container instanceof HTMLDivElement?n.concat(this.config.container):Array.from(document.querySelectorAll(this.config.container));for(var i=0;i<n.length;i+=1)this.createButton({personalization:this.config.personalization,buttonProps:this.config.buttonProps,mintsifry:this.config.https,changeUser:this.config.changeUser,getHasCertificate:this.config.https.enable?this.getHasCertificate:void 0,debug:this.config.debug,onButtonClick:this.onButtonClick,container:n[i],setIsButtonPersonalized:this.setIsButtonPersonalized})}this.setOIDCParams(this.config.oidc),this.config.personalization?this.getUser().then((function(e){t.config.onPersonalizationStatus&&t.config.onPersonalizationStatus(e),"auto"===t.config.fastLogin.mode&&t.config.fastLogin.onErrorAutoMode&&!e&&t.config.fastLogin.onErrorAutoMode()})):this.isBannerClosed||null==(e=this.notifyBanner)||e.show()}},{key:"createButton",value:function(e){var t=new yn(e);this.buttons.push(t)}},{key:"getHasCertificate",value:function(){return this.hasCertificate}},{key:"handleUserChange",value:function(e){this.user=e}},{key:"silentAuthorization",value:(o=l(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fastLogin.authorization(this.oidcParams,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"getUser",value:(r=l(c().mark((function e(){var t,n,i=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return vt(),this.config.debug&&ft(["Получаем информацию о пользователе"],"info"),e.next=3,this.userHelper.getUser().catch((function(e){i.config.debug&&ft(["Ошибка при получении данных о пользователе",e],"error")}));case 3:if(n=e.sent,this.config.debug&&ft(["Показывать баннер : ".concat(!this.isBannerClosed)],"info"),this.isBannerClosed||null==(t=this.notifyBanner)||t.show(),!n){e.next=13;break}return e.next=9,this.onGetUserSuccess(n);case 9:bt(),e.t0=!0,e.next=14;break;case 13:e.t0=(this.config.debug&&ft(["Ошибка при получении данных о пользователе, объект user не существует"],"error"),bt(),!1);case 14:return e.abrupt("return",e.t0);case 15:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"handleButtonClick",value:(i=l(c().mark((function e(t,n){var i,r,o,s,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.w=void 0,t.preventDefault(),t.stopPropagation(),"disabled"!==(null==n?void 0:n.getAttribute("disabled"))&&"true"!==(null==n?void 0:n.getAttribute("disabled"))&&"loading"!==(null==n?void 0:n.getAttribute("loading"))){e.next=2;break}return e.abrupt("return",!1);case 2:if(vt(),this.disable(),bn({eventCategory:"Login",eventAction:"sberid_Login_Button_Click",eventType:"Result",extendedProperties:{personalization:"true"===(null==(i=null==n?void 0:n.dataset)?void 0:i.personalization),machineClick:this.user&&this.config.fastLogin?k.FAST_LOGIN:k.NONE}}),s=(null==(r=t.target.closest(".sbid-button"))?void 0:r.getAttribute("href"))||"",!this.user||!this.config.fastLogin.enable){e.next=20;break}return e.next=7,this.silentAuthorization(k.FAST_LOGIN);case 7:if(!(a=e.sent).success){e.next=12;break}this.config.debug&&ft(["Успешный быстрый вход",a.data],"success"),this.onSuccessCallback(a.data),null==(o=this.notifyBanner)||o.onClose(),e.next=17;break;case 12:if(this.config.debug&&ft(["Ошибка быстрого входа",a.data],"error"),!this.config.fastLogin.onErrorDefaultMode||this.config.fastLogin.onErrorDefaultMode()){e.next=14;break}return e.abrupt("return",(bt(),this.enable(),!1));case 14:if("popup"!==this.config.display||"desktop"!==this.parser.getPlatformType(!0)){e.next=16;break}return e.abrupt("return",(this.openDialog(s),!1));case 16:bt(),window.location.href=s;case 17:bt(),this.enable(),e.next=23;break;case 20:if("popup"!==this.config.display||"desktop"!==this.parser.getPlatformType(!0)){e.next=22;break}return e.abrupt("return",(this.openDialog(s),!1));case 22:bt(),window.location.href=s;case 23:return e.abrupt("return",!1);case 24:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"onGetUserSuccess",value:(n=l(c().mark((function e(t){var n,i,r,o,s,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.user=t,this.config.debug&&ft(["Данные о пользователе получены",t],"success"),!this.user||!this.config.fastLogin||"auto"!==this.config.fastLogin.mode||this.isExitedFromAutoLogin||this.autoUpdateCookie){e.next=16;break}return vt(),this.disable(),e.prev=2,bn({eventCategory:"Login",eventAction:"sberid_Login_Button_Click",eventType:"Result",extendedProperties:{machineClick:k.AGRESSIVE_LOGIN}}),e.next=6,this.silentAuthorization(k.AGRESSIVE_LOGIN);case 6:a=e.sent,this.config.debug&&ft(["Автоматический вход",a],"info"),a.success?(this.config.debug&&ft(["Успешный быстрый вход",a.data],"success"),this.onSuccessCallback&&this.onSuccessCallback(a.data),null==(n=this.notifyBanner)||n.onClose()):(this.config.debug&&ft(["Автоматический вход не удался"],"error"),null==(r=(i=this.config.fastLogin).onErrorAutoMode)||r.call(i)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),this.config.debug&&ft(["Автоматический вход не удался",e.t0],"error"),null==(s=(o=this.config.fastLogin).onErrorAutoMode)||s.call(o);case 13:return e.prev=13,bt(),this.enable(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[2,10,13,16]])}))),function(e){return n.apply(this,arguments)})},{key:"sbUniversalLinkCallback",value:function(e){for(var t=0;t<this.buttons.length;t+=1)this.buttons[t].setUrl(e.link)}},{key:"checkState",value:function(e){var t=Cn.get("sbid_state");return!e||t===e||(this.w&&(this.windowStatus="closed",this.w.close()),"function"==typeof this.onErrorCallback&&this.onErrorCallback({code:"error",error:"invalid_state",description:Xe.invalid_state}),Cn.delete("sbid_state"),!1)}},{key:"listener",value:function(e){var t={};try{t=JSON.parse(e.data)}catch(t){this.config.debug&&ft(["Ошибка при обработке postMessage",e.data],"info")}if((!this.config.generateState||this.checkState(null==t?void 0:t.state))&&t&&("success"===t.status||"error"===t.status)&&(this.w&&(this.windowStatus="closed",this.w.close(),this.w=void 0),"success"===t.status&&"function"==typeof this.onSuccessCallback&&(bn({eventCategory:"Login",eventAction:"sberid_Login_Auth_Result",eventType:"Result",result:"success"}),bt(),this.enable(),this.onSuccessCallback(t)),"error"===t.status&&"function"==typeof this.onErrorCallback)){var n=t.error+"_"+t.description;bn({eventCategory:"Login",eventAction:"sberid_Login_Auth_Result",eventType:"Result",result:"fail",description:n}),bt(),this.enable(),this.onErrorCallback(t)}}},{key:"addWindowListener",value:function(){var e=this.listener.bind(this);return window.addEventListener("message",e),this.config.debug&&ft(["Добавляем обработчики при открытии окна."],"info"),function(){return ft(["Удаляем обработчики открытого окна."],"info"),window.removeEventListener("message",e)}}},{key:"openDialog",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.config.debug&&ft(["Открываем окно авторизации через Сбер ID."],"info"),this.config.cloud.enable&&(n.width=850),this.w=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={directories:"no",status:"no",menubar:"no",scrollbars:"yes",resizable:"no",width:600,height:745,centered:!0};if(Object.keys(n).forEach((function(e){t[e]=t.hasOwnProperty(e)?t[e]:n[e]})),t.centered){var i=m(window.screenX)<"u"?window.screenX:window.screenLeft,r=m(window.screenY)<"u"?window.screenY:window.screenTop;t.left=parseInt("".concat(i+(window.innerWidth-t.width)/2),10),t.top=parseInt("".concat(r+(window.innerHeight-t.height)/2),10)}var o=window.open(e,"_blank",Object.keys(t).map((function(e){return e+"="+t[e]})).join(",")),s=[],a=setInterval((function(){o&&o.closed&&(clearInterval(a),s.forEach((function(e){e&&e()})))}));return o&&(o.onclose=function(e){s.push(e)}),o}(e,n),this.w){this.windowStatus="opened",this.removeWindowListener=this.addWindowListener();var i=setInterval((function(){(!t.w||t.w.closed)&&(clearInterval(i),t.closeCallback())}),100)}}},{key:"closeCallback",value:function(){(this.config.debug&&ft(["Вызываем функцию обратного вызова при закрытии окна."],"info"),"closed"!==this.windowStatus&&(this.windowStatus="closed",this.w=void 0,"function"==typeof this.onErrorCallback))&&(bn({eventCategory:"Login",eventAction:"sberid_Login_Auth_Result",eventType:"Result",result:"fail",description:"window_closed_"+Xe.window_closed}),bt(),this.enable(),this.onErrorCallback({code:"error",error:"window_closed",description:Xe.window_closed}));this.removeWindowListener()}}],[{key:"getVersion",value:function(){return"3.6.0"}},{key:"getUrl",value:(t=l(c().mark((function e(t,n,i){var r,o,s,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new _n(h({baseUrl:t,oidcParams:n},i)),e.next=3,r.run(n);case 3:return o=e.sent,s=o.link,a=o.deeplink,e.abrupt("return",{deeplink:a,link:s});case 7:case"end":return e.stop()}}),e)}))),function(e,n,i){return t.apply(this,arguments)})},{key:"logout",value:function(e){bn({eventCategory:"Logout",eventAction:"sberid_Logout_Auth_Result",eventType:"Result",result:"success"});var t=Number(Cn.get("sbid_exit_auto_login_count"))||0,n=new Date;Cn.set("sbid_exited_from_auto_login","1",{domain:e,path:"/",expires:this.getCookieExpires(t)}),Cn.set("sbid_exit_auto_login_count","".concat(t+1),{domain:e,path:"/",expires:new Date(n.getFullYear()+1,n.getMonth(),n.getDate())})}},{key:"getCookieExpires",value:function(e){var t=[7200,86400,604800,2419200],n=e||0;return e>=t.length&&(n=t.length-1),t[n]}}]),e}();function Hn(e){return new Mn(e)}window.SberidSDK=Mn;export{Ue as BASE_DEEPLINK_URL,Oe as BASE_URL,An as NotificationPosition,Un as NotificationTextType,On as NotificationTheme,L as OtherAuthService,Mn as SberidSDK,_n as SberidUniversalLink,Ut as UserHelper,Hn as default,Be as getAuthUrl,De as getUniversalLinkAuthUrl,ut as getVersion,bt as hideLoader,vn as initSA,bn as sendSberAnalytics,vt as showLoader,mt as successWindowListener};
